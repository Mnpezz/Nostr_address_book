/*! For license information please see nostr-bundle.js.LICENSE.txt */
(()=>{"use strict";var n={d:(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o:(n,e)=>Object.prototype.hasOwnProperty.call(n,e),r:n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})}},e={};n.r(e),n.d(e,{OG:()=>q,My:()=>O,Ph:()=>T,lX:()=>N,Id:()=>H,fg:()=>F,qj:()=>j,aT:()=>_,lq:()=>R,z:()=>K,Q5:()=>D});var t={};function r(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`Wrong positive integer: ${n}`)}function i(n,...e){if(!(n instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(n.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${n.length}`)}n.r(t),n.d(t,{Kind:()=>Gt,SimplePool:()=>wr,eventsGenerator:()=>gr,finishEvent:()=>Jt,fj:()=>ar,generatePrivateKey:()=>Kt,getBlankEvent:()=>Wt,getEventHash:()=>Qt,getPublicKey:()=>jt,getSignature:()=>rr,matchFilter:()=>ir,matchFilters:()=>or,mergeFilters:()=>sr,nip04:()=>Nr,nip05:()=>Hr,nip06:()=>Dr,nip10:()=>Wr,nip13:()=>Yr,nip18:()=>ni,nip19:()=>br,nip21:()=>ii,nip25:()=>ci,nip26:()=>hi,nip27:()=>pi,nip28:()=>bi,nip39:()=>Bi,nip42:()=>Li,nip44:()=>Ci,nip47:()=>Ti,nip57:()=>ji,nip98:()=>Mi,parseReferences:()=>Tr,relayInit:()=>yr,serializeEvent:()=>Yt,signEvent:()=>tr,utils:()=>Ht,validateEvent:()=>nr,verifiedSymbol:()=>Zt,verifySignature:()=>er});const o={number:r,bool:function(n){if("boolean"!=typeof n)throw new Error(`Expected boolean, not ${n}`)},bytes:i,hash:function(n){if("function"!=typeof n||"function"!=typeof n.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");r(n.outputLen),r(n.blockLen)},exists:function(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")},output:function(n,e){i(n);const t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}},s="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,a=n=>n instanceof Uint8Array,c=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),l=(n,e)=>n<<32-e|n>>>e;if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");const u=Array.from({length:256},((n,e)=>e.toString(16).padStart(2,"0")));function h(n){if(!a(n))throw new Error("Uint8Array expected");let e="";for(let t=0;t<n.length;t++)e+=u[n[t]];return e}function d(n){if("string"!=typeof n)throw new Error("hex string expected, got "+typeof n);const e=n.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let e=0;e<t.length;e++){const r=2*e,i=n.slice(r,r+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[e]=o}return t}function f(n){if("string"!=typeof n)throw new Error("utf8ToBytes expected string, got "+typeof n);return new Uint8Array((new TextEncoder).encode(n))}function p(n){if("string"==typeof n&&(n=f(n)),!a(n))throw new Error("expected Uint8Array, got "+typeof n);return n}function y(...n){const e=new Uint8Array(n.reduce(((n,e)=>n+e.length),0));let t=0;return n.forEach((n=>{if(!a(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length})),e}class g{clone(){return this._cloneInto()}}function w(n){const e=e=>n().update(p(e)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function b(n=32){if(s&&"function"==typeof s.getRandomValues)return s.getRandomValues(new Uint8Array(n));throw new Error("crypto.getRandomValues must be defined")}class m extends g{constructor(n,e,t,r){super(),this.blockLen=n,this.outputLen=e,this.padOffset=t,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(n),this.view=c(this.buffer)}update(n){o.exists(this);const{view:e,buffer:t,blockLen:r}=this,i=(n=p(n)).length;for(let o=0;o<i;){const s=Math.min(r-this.pos,i-o);if(s!==r)t.set(n.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===r&&(this.process(e,0),this.pos=0);else{const e=c(n);for(;r<=i-o;o+=r)this.process(e,o)}}return this.length+=n.length,this.roundClean(),this}digestInto(n){o.exists(this),o.output(n,this),this.finished=!0;const{buffer:e,view:t,blockLen:r,isLE:i}=this;let{pos:s}=this;e[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>r-s&&(this.process(t,0),s=0);for(let n=s;n<r;n++)e[n]=0;!function(n,e,t,r){if("function"==typeof n.setBigUint64)return n.setBigUint64(e,t,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(t>>i&o),a=Number(t&o),c=r?4:0,l=r?0:4;n.setUint32(e+c,s,r),n.setUint32(e+l,a,r)}(t,r-8,BigInt(8*this.length),i),this.process(t,0);const a=c(n),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=l/4,h=this.get();if(u>h.length)throw new Error("_sha2: outputLen bigger than state");for(let n=0;n<u;n++)a.setUint32(4*n,h[n],i)}digest(){const{buffer:n,outputLen:e}=this;this.digestInto(n);const t=n.slice(0,e);return this.destroy(),t}_cloneInto(n){n||(n=new this.constructor),n.set(...this.get());const{blockLen:e,buffer:t,length:r,finished:i,destroyed:o,pos:s}=this;return n.length=r,n.pos=s,n.finished=i,n.destroyed=o,r%e&&n.buffer.set(t),n}}const v=(n,e,t)=>n&e^n&t^e&t,E=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),x=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),k=new Uint32Array(64);class A extends m{constructor(){super(64,32,8,!1),this.A=0|x[0],this.B=0|x[1],this.C=0|x[2],this.D=0|x[3],this.E=0|x[4],this.F=0|x[5],this.G=0|x[6],this.H=0|x[7]}get(){const{A:n,B:e,C:t,D:r,E:i,F:o,G:s,H:a}=this;return[n,e,t,r,i,o,s,a]}set(n,e,t,r,i,o,s,a){this.A=0|n,this.B=0|e,this.C=0|t,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(n,e){for(let t=0;t<16;t++,e+=4)k[t]=n.getUint32(e,!1);for(let n=16;n<64;n++){const e=k[n-15],t=k[n-2],r=l(e,7)^l(e,18)^e>>>3,i=l(t,17)^l(t,19)^t>>>10;k[n]=i+k[n-7]+r+k[n-16]|0}let{A:t,B:r,C:i,D:o,E:s,F:a,G:c,H:u}=this;for(let n=0;n<64;n++){const e=u+(l(s,6)^l(s,11)^l(s,25))+((h=s)&a^~h&c)+E[n]+k[n]|0,d=(l(t,2)^l(t,13)^l(t,22))+v(t,r,i)|0;u=c,c=a,a=s,s=o+e|0,o=i,i=r,r=t,t=e+d|0}var h;t=t+this.A|0,r=r+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(t,r,i,o,s,a,c,u)}roundClean(){k.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class B extends A{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const S=w((()=>new A)),I=(w((()=>new B)),BigInt(0),BigInt(1)),L=BigInt(2),U=n=>n instanceof Uint8Array,C=Array.from({length:256},((n,e)=>e.toString(16).padStart(2,"0")));function O(n){if(!U(n))throw new Error("Uint8Array expected");let e="";for(let t=0;t<n.length;t++)e+=C[n[t]];return e}function $(n){if("string"!=typeof n)throw new Error("hex string expected, got "+typeof n);return BigInt(""===n?"0":`0x${n}`)}function _(n){if("string"!=typeof n)throw new Error("hex string expected, got "+typeof n);const e=n.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let e=0;e<t.length;e++){const r=2*e,i=n.slice(r,r+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[e]=o}return t}function T(n){return $(O(n))}function N(n){if(!U(n))throw new Error("Uint8Array expected");return $(O(Uint8Array.from(n).reverse()))}function R(n,e){return _(n.toString(16).padStart(2*e,"0"))}function K(n,e){return R(n,e).reverse()}function j(n,e,t){let r;if("string"==typeof e)try{r=_(e)}catch(t){throw new Error(`${n} must be valid hex string, got "${e}". Cause: ${t}`)}else{if(!U(e))throw new Error(`${n} must be hex string or Uint8Array`);r=Uint8Array.from(e)}const i=r.length;if("number"==typeof t&&i!==t)throw new Error(`${n} expected ${t} bytes, got ${i}`);return r}function H(...n){const e=new Uint8Array(n.reduce(((n,e)=>n+e.length),0));let t=0;return n.forEach((n=>{if(!U(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length})),e}const q=n=>(L<<BigInt(n-1))-I,P=n=>new Uint8Array(n),z=n=>Uint8Array.from(n);function F(n,e,t){if("number"!=typeof n||n<2)throw new Error("hashLen must be a number");if("number"!=typeof e||e<2)throw new Error("qByteLen must be a number");if("function"!=typeof t)throw new Error("hmacFn must be a function");let r=P(n),i=P(n),o=0;const s=()=>{r.fill(1),i.fill(0),o=0},a=(...n)=>t(i,r,...n),c=(n=P())=>{i=a(z([0]),n),r=a(),0!==n.length&&(i=a(z([1]),n),r=a())},l=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let n=0;const t=[];for(;n<e;){r=a();const e=r.slice();t.push(e),n+=r.length}return H(...t)};return(n,e)=>{let t;for(s(),c(n);!(t=e(l()));)c();return s(),t}}const M={bigint:n=>"bigint"==typeof n,function:n=>"function"==typeof n,boolean:n=>"boolean"==typeof n,string:n=>"string"==typeof n,isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,e)=>e.Fp.isValid(n),hash:n=>"function"==typeof n&&Number.isSafeInteger(n.outputLen)};function D(n,e,t={}){const r=(e,t,r)=>{const i=M[t];if("function"!=typeof i)throw new Error(`Invalid validator "${t}", expected function`);const o=n[e];if(!(r&&void 0===o||i(o,n)))throw new Error(`Invalid param ${String(e)}=${o} (${typeof o}), expected ${t}`)};for(const[n,t]of Object.entries(e))r(n,t,!1);for(const[n,e]of Object.entries(t))r(n,e,!0);return n}const V=BigInt(0),Z=BigInt(1),G=BigInt(2),W=BigInt(3),J=BigInt(4),Y=BigInt(5),Q=BigInt(8);function X(n,e){const t=n%e;return t>=V?t:e+t}function nn(n,e,t){if(t<=V||e<V)throw new Error("Expected power/modulo > 0");if(t===Z)return V;let r=Z;for(;e>V;)e&Z&&(r=r*n%t),n=n*n%t,e>>=Z;return r}function en(n,e,t){let r=n;for(;e-- >V;)r*=r,r%=t;return r}function tn(n,e){if(n===V||e<=V)throw new Error(`invert: expected positive integers, got n=${n} mod=${e}`);let t=X(n,e),r=e,i=V,o=Z,s=Z,a=V;for(;t!==V;){const n=r/t,e=r%t,c=i-s*n,l=o-a*n;r=t,t=e,i=s,o=a,s=c,a=l}if(r!==Z)throw new Error("invert: does not exist");return X(i,e)}BigInt(9),BigInt(16);const rn=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function on(n,e){const t=void 0!==e?e:n.toString(2).length;return{nBitLength:t,nByteLength:Math.ceil(t/8)}}const sn=BigInt(0),an=BigInt(1);function cn(n){return D(n.Fp,rn.reduce(((n,e)=>(n[e]="function",n)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),D(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...on(n.n,n.nBitLength),...n,p:n.Fp.ORDER})}const{Ph:ln,aT:un}=e,hn={Err:class extends Error{constructor(n=""){super(n)}},_parseInt(n){const{Err:e}=hn;if(n.length<2||2!==n[0])throw new e("Invalid signature integer tag");const t=n[1],r=n.subarray(2,t+2);if(!t||r.length!==t)throw new e("Invalid signature integer: wrong length");if(128&r[0])throw new e("Invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new e("Invalid signature integer: unnecessary leading zero");return{d:ln(r),l:n.subarray(t+2)}},toSig(n){const{Err:e}=hn,t="string"==typeof n?un(n):n;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let r=t.length;if(r<2||48!=t[0])throw new e("Invalid signature tag");if(t[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:i,l:o}=hn._parseInt(t.subarray(2)),{d:s,l:a}=hn._parseInt(o);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(n){const e=n=>8&Number.parseInt(n[0],16)?"00"+n:n,t=n=>{const e=n.toString(16);return 1&e.length?`0${e}`:e},r=e(t(n.s)),i=e(t(n.r)),o=r.length/2,s=i.length/2,a=t(o),c=t(s);return`30${t(s+o+4)}02${c}${i}02${a}${r}`}},dn=BigInt(0),fn=BigInt(1),pn=(BigInt(2),BigInt(3));function yn(n){const e=function(n){const e=cn(n);return D(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(n),{Fp:t,n:r}=e,i=t.BYTES+1,o=2*t.BYTES+1;function s(n){return X(n,r)}function a(n){return tn(n,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:l,weierstrassEquation:u,isWithinCurveOrder:h}=function(n){const e=function(n){const e=cn(n);D(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:r,a:i}=e;if(t){if(!r.eql(i,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof t||"bigint"!=typeof t.beta||"function"!=typeof t.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(n),{Fp:t}=e,r=e.toBytes||((n,e,r)=>{const i=e.toAffine();return H(Uint8Array.from([4]),t.toBytes(i.x),t.toBytes(i.y))}),i=e.fromBytes||(n=>{const e=n.subarray(1);return{x:t.fromBytes(e.subarray(0,t.BYTES)),y:t.fromBytes(e.subarray(t.BYTES,2*t.BYTES))}});function o(n){const{a:r,b:i}=e,o=t.sqr(n),s=t.mul(o,n);return t.add(t.add(s,t.mul(n,r)),i)}if(!t.eql(t.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function s(n){return"bigint"==typeof n&&dn<n&&n<e.n}function a(n){if(!s(n))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(n){const{allowedPrivateKeyLengths:t,nByteLength:r,wrapPrivateKey:i,n:o}=e;if(t&&"bigint"!=typeof n){if(n instanceof Uint8Array&&(n=O(n)),"string"!=typeof n||!t.includes(n.length))throw new Error("Invalid key");n=n.padStart(2*r,"0")}let s;try{s="bigint"==typeof n?n:T(j("private key",n,r))}catch(e){throw new Error(`private key must be ${r} bytes, hex or bigint, not ${typeof n}`)}return i&&(s=X(s,o)),a(s),s}const l=new Map;function u(n){if(!(n instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(n,e,r){if(this.px=n,this.py=e,this.pz=r,null==n||!t.isValid(n))throw new Error("x required");if(null==e||!t.isValid(e))throw new Error("y required");if(null==r||!t.isValid(r))throw new Error("z required")}static fromAffine(n){const{x:e,y:r}=n||{};if(!n||!t.isValid(e)||!t.isValid(r))throw new Error("invalid affine point");if(n instanceof h)throw new Error("projective point not allowed");const i=n=>t.eql(n,t.ZERO);return i(e)&&i(r)?h.ZERO:new h(e,r,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(n){const e=t.invertBatch(n.map((n=>n.pz)));return n.map(((n,t)=>n.toAffine(e[t]))).map(h.fromAffine)}static fromHex(n){const e=h.fromAffine(i(j("pointHex",n)));return e.assertValidity(),e}static fromPrivateKey(n){return h.BASE.multiply(c(n))}_setWindowSize(n){this._WINDOW_SIZE=n,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint)return;throw new Error("bad point: ZERO")}const{x:n,y:r}=this.toAffine();if(!t.isValid(n)||!t.isValid(r))throw new Error("bad point: x or y not FE");const i=t.sqr(r),s=o(n);if(!t.eql(i,s))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:n}=this.toAffine();if(t.isOdd)return!t.isOdd(n);throw new Error("Field doesn't support isOdd")}equals(n){u(n);const{px:e,py:r,pz:i}=this,{px:o,py:s,pz:a}=n,c=t.eql(t.mul(e,a),t.mul(o,i)),l=t.eql(t.mul(r,a),t.mul(s,i));return c&&l}negate(){return new h(this.px,t.neg(this.py),this.pz)}double(){const{a:n,b:r}=e,i=t.mul(r,pn),{px:o,py:s,pz:a}=this;let c=t.ZERO,l=t.ZERO,u=t.ZERO,d=t.mul(o,o),f=t.mul(s,s),p=t.mul(a,a),y=t.mul(o,s);return y=t.add(y,y),u=t.mul(o,a),u=t.add(u,u),c=t.mul(n,u),l=t.mul(i,p),l=t.add(c,l),c=t.sub(f,l),l=t.add(f,l),l=t.mul(c,l),c=t.mul(y,c),u=t.mul(i,u),p=t.mul(n,p),y=t.sub(d,p),y=t.mul(n,y),y=t.add(y,u),u=t.add(d,d),d=t.add(u,d),d=t.add(d,p),d=t.mul(d,y),l=t.add(l,d),p=t.mul(s,a),p=t.add(p,p),d=t.mul(p,y),c=t.sub(c,d),u=t.mul(p,f),u=t.add(u,u),u=t.add(u,u),new h(c,l,u)}add(n){u(n);const{px:r,py:i,pz:o}=this,{px:s,py:a,pz:c}=n;let l=t.ZERO,d=t.ZERO,f=t.ZERO;const p=e.a,y=t.mul(e.b,pn);let g=t.mul(r,s),w=t.mul(i,a),b=t.mul(o,c),m=t.add(r,i),v=t.add(s,a);m=t.mul(m,v),v=t.add(g,w),m=t.sub(m,v),v=t.add(r,o);let E=t.add(s,c);return v=t.mul(v,E),E=t.add(g,b),v=t.sub(v,E),E=t.add(i,o),l=t.add(a,c),E=t.mul(E,l),l=t.add(w,b),E=t.sub(E,l),f=t.mul(p,v),l=t.mul(y,b),f=t.add(l,f),l=t.sub(w,f),f=t.add(w,f),d=t.mul(l,f),w=t.add(g,g),w=t.add(w,g),b=t.mul(p,b),v=t.mul(y,v),w=t.add(w,b),b=t.sub(g,b),b=t.mul(p,b),v=t.add(v,b),g=t.mul(w,v),d=t.add(d,g),g=t.mul(E,v),l=t.mul(m,l),l=t.sub(l,g),g=t.mul(m,w),f=t.mul(E,f),f=t.add(f,g),new h(l,d,f)}subtract(n){return this.add(n.negate())}is0(){return this.equals(h.ZERO)}wNAF(n){return f.wNAFCached(this,l,n,(n=>{const e=t.invertBatch(n.map((n=>n.pz)));return n.map(((n,t)=>n.toAffine(e[t]))).map(h.fromAffine)}))}multiplyUnsafe(n){const r=h.ZERO;if(n===dn)return r;if(a(n),n===fn)return this;const{endo:i}=e;if(!i)return f.unsafeLadder(this,n);let{k1neg:o,k1:s,k2neg:c,k2:l}=i.splitScalar(n),u=r,d=r,p=this;for(;s>dn||l>dn;)s&fn&&(u=u.add(p)),l&fn&&(d=d.add(p)),p=p.double(),s>>=fn,l>>=fn;return o&&(u=u.negate()),c&&(d=d.negate()),d=new h(t.mul(d.px,i.beta),d.py,d.pz),u.add(d)}multiply(n){a(n);let r,i,o=n;const{endo:s}=e;if(s){const{k1neg:n,k1:e,k2neg:a,k2:c}=s.splitScalar(o);let{p:l,f:u}=this.wNAF(e),{p:d,f:p}=this.wNAF(c);l=f.constTimeNegate(n,l),d=f.constTimeNegate(a,d),d=new h(t.mul(d.px,s.beta),d.py,d.pz),r=l.add(d),i=u.add(p)}else{const{p:n,f:e}=this.wNAF(o);r=n,i=e}return h.normalizeZ([r,i])[0]}multiplyAndAddUnsafe(n,e,t){const r=h.BASE,i=(n,e)=>e!==dn&&e!==fn&&n.equals(r)?n.multiply(e):n.multiplyUnsafe(e),o=i(this,e).add(i(n,t));return o.is0()?void 0:o}toAffine(n){const{px:e,py:r,pz:i}=this,o=this.is0();null==n&&(n=o?t.ONE:t.inv(i));const s=t.mul(e,n),a=t.mul(r,n),c=t.mul(i,n);if(o)return{x:t.ZERO,y:t.ZERO};if(!t.eql(c,t.ONE))throw new Error("invZ was invalid");return{x:s,y:a}}isTorsionFree(){const{h:n,isTorsionFree:t}=e;if(n===fn)return!0;if(t)return t(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:n,clearCofactor:t}=e;return n===fn?this:t?t(h,this):this.multiplyUnsafe(e.h)}toRawBytes(n=!0){return this.assertValidity(),r(h,this,n)}toHex(n=!0){return O(this.toRawBytes(n))}}h.BASE=new h(e.Gx,e.Gy,t.ONE),h.ZERO=new h(t.ZERO,t.ONE,t.ZERO);const d=e.nBitLength,f=function(n,e){const t=(n,e)=>{const t=e.negate();return n?t:e},r=n=>({windows:Math.ceil(e/n)+1,windowSize:2**(n-1)});return{constTimeNegate:t,unsafeLadder(e,t){let r=n.ZERO,i=e;for(;t>sn;)t&an&&(r=r.add(i)),i=i.double(),t>>=an;return r},precomputeWindow(n,e){const{windows:t,windowSize:i}=r(e),o=[];let s=n,a=s;for(let n=0;n<t;n++){a=s,o.push(a);for(let n=1;n<i;n++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(e,i,o){const{windows:s,windowSize:a}=r(e);let c=n.ZERO,l=n.BASE;const u=BigInt(2**e-1),h=2**e,d=BigInt(e);for(let n=0;n<s;n++){const e=n*a;let r=Number(o&u);o>>=d,r>a&&(r-=h,o+=an);const s=e,f=e+Math.abs(r)-1,p=n%2!=0,y=r<0;0===r?l=l.add(t(p,i[s])):c=c.add(t(y,i[f]))}return{p:c,f:l}},wNAFCached(n,e,t,r){const i=n._WINDOW_SIZE||1;let o=e.get(n);return o||(o=this.precomputeWindow(n,i),1!==i&&e.set(n,r(o))),this.wNAF(i,o,t)}}}(h,e.endo?Math.ceil(d/2):d);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:s}}({...e,toBytes(n,e,r){const i=e.toAffine(),o=t.toBytes(i.x),s=H;return r?s(Uint8Array.from([e.hasEvenY()?2:3]),o):s(Uint8Array.from([4]),o,t.toBytes(i.y))},fromBytes(n){const e=n.length,r=n[0],s=n.subarray(1);if(e!==i||2!==r&&3!==r){if(e===o&&4===r)return{x:t.fromBytes(s.subarray(0,t.BYTES)),y:t.fromBytes(s.subarray(t.BYTES,2*t.BYTES))};throw new Error(`Point of length ${e} was invalid. Expected ${i} compressed bytes or ${o} uncompressed bytes`)}{const n=T(s);if(!(dn<(a=n)&&a<t.ORDER))throw new Error("Point is not on curve");const e=u(n);let i=t.sqrt(e);return!(1&~r)!=((i&fn)===fn)&&(i=t.neg(i)),{x:n,y:i}}var a}}),d=n=>O(R(n,e.nByteLength));function f(n){return n>r>>fn}const p=(n,e,t)=>T(n.slice(e,t));class y{constructor(n,e,t){this.r=n,this.s=e,this.recovery=t,this.assertValidity()}static fromCompact(n){const t=e.nByteLength;return n=j("compactSignature",n,2*t),new y(p(n,0,t),p(n,t,2*t))}static fromDER(n){const{r:e,s:t}=hn.toSig(j("DER",n));return new y(e,t)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(n){return new y(this.r,this.s,n)}recoverPublicKey(n){const{r,s:i,recovery:o}=this,l=m(j("msgHash",n));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");const u=2===o||3===o?r+e.n:r;if(u>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const h=1&o?"03":"02",f=c.fromHex(h+d(u)),p=a(u),y=s(-l*p),g=s(i*p),w=c.BASE.multiplyAndAddUnsafe(f,y,g);if(!w)throw new Error("point at infinify");return w.assertValidity(),w}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new y(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return _(this.toDERHex())}toDERHex(){return hn.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return _(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const g={isValidPrivateKey(n){try{return l(n),!0}catch(n){return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>R(function(n,e,t=!1){const r=(n=j("privateHash",n)).length,i=on(e).nByteLength+8;if(i<24||r<i||r>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${r}`);return X(t?N(n):T(n),e-Z)+Z}(e.randomBytes(t.BYTES+8),r),e.nByteLength),precompute:(n=8,e=c.BASE)=>(e._setWindowSize(n),e.multiply(BigInt(3)),e)};function w(n){const e=n instanceof Uint8Array,t="string"==typeof n,r=(e||t)&&n.length;return e?r===i||r===o:t?r===2*i||r===2*o:n instanceof c}const b=e.bits2int||function(n){const t=T(n),r=8*n.length-e.nBitLength;return r>0?t>>BigInt(r):t},m=e.bits2int_modN||function(n){return s(b(n))},v=q(e.nBitLength);function E(n){if("bigint"!=typeof n)throw new Error("bigint expected");if(!(dn<=n&&n<v))throw new Error(`bigint expected < 2^${e.nBitLength}`);return R(n,e.nByteLength)}const x={lowS:e.lowS,prehash:!1},k={lowS:e.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(n,e=!0){return c.fromPrivateKey(n).toRawBytes(e)},getSharedSecret:function(n,e,t=!0){if(w(n))throw new Error("first arg must be private key");if(!w(e))throw new Error("second arg must be public key");return c.fromHex(e).multiply(l(n)).toRawBytes(t)},sign:function(n,r,i=x){const{seed:o,k2sig:u}=function(n,r,i=x){if(["recovered","canonical"].some((n=>n in i)))throw new Error("sign() legacy options not supported");const{hash:o,randomBytes:u}=e;let{lowS:d,prehash:p,extraEntropy:g}=i;null==d&&(d=!0),n=j("msgHash",n),p&&(n=j("prehashed msgHash",o(n)));const w=m(n),v=l(r),k=[E(v),E(w)];if(null!=g){const n=!0===g?u(t.BYTES):g;k.push(j("extraEntropy",n,t.BYTES))}const A=H(...k),B=w;return{seed:A,k2sig:function(n){const e=b(n);if(!h(e))return;const t=a(e),r=c.BASE.multiply(e).toAffine(),i=s(r.x);if(i===dn)return;const o=s(t*s(B+i*v));if(o===dn)return;let l=(r.x===i?0:2)|Number(r.y&fn),u=o;return d&&f(o)&&(u=function(n){return f(n)?s(-n):n}(o),l^=1),new y(i,u,l)}}}(n,r,i),d=e;return F(d.hash.outputLen,d.nByteLength,d.hmac)(o,u)},verify:function(n,t,r,i=k){const o=n;if(t=j("msgHash",t),r=j("publicKey",r),"strict"in i)throw new Error("options.strict was renamed to lowS");const{lowS:l,prehash:u}=i;let h,d;try{if("string"==typeof o||o instanceof Uint8Array)try{h=y.fromDER(o)}catch(n){if(!(n instanceof hn.Err))throw n;h=y.fromCompact(o)}else{if("object"!=typeof o||"bigint"!=typeof o.r||"bigint"!=typeof o.s)throw new Error("PARSE");{const{r:n,s:e}=o;h=new y(n,e)}}d=c.fromHex(r)}catch(n){if("PARSE"===n.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(l&&h.hasHighS())return!1;u&&(t=e.hash(t));const{r:f,s:p}=h,g=m(t),w=a(p),b=s(g*w),v=s(f*w),E=c.BASE.multiplyAndAddUnsafe(d,b,v)?.toAffine();return!!E&&s(E.x)===f},ProjectivePoint:c,Signature:y,utils:g}}BigInt(4);class gn extends g{constructor(n,e){super(),this.finished=!1,this.destroyed=!1,o.hash(n);const t=p(e);if(this.iHash=n.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(t.length>r?n.create().update(t).digest():t);for(let n=0;n<i.length;n++)i[n]^=54;this.iHash.update(i),this.oHash=n.create();for(let n=0;n<i.length;n++)i[n]^=106;this.oHash.update(i),i.fill(0)}update(n){return o.exists(this),this.iHash.update(n),this}digestInto(n){o.exists(this),o.bytes(n,this.outputLen),this.finished=!0,this.iHash.digestInto(n),this.oHash.update(n),this.oHash.digestInto(n),this.destroy()}digest(){const n=new Uint8Array(this.oHash.outputLen);return this.digestInto(n),n}_cloneInto(n){n||(n=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:t,finished:r,destroyed:i,blockLen:o,outputLen:s}=this;return n.finished=r,n.destroyed=i,n.blockLen=o,n.outputLen=s,n.oHash=e._cloneInto(n.oHash),n.iHash=t._cloneInto(n.iHash),n}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const wn=(n,e,t)=>new gn(n,e).update(t).digest();function bn(n){return{hash:n,hmac:(e,...t)=>wn(n,e,y(...t)),randomBytes:b}}wn.create=(n,e)=>new gn(n,e);const mn=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),vn=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),En=BigInt(1),xn=BigInt(2),kn=(n,e)=>(n+e/xn)/e;function An(n){const e=mn,t=BigInt(3),r=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),l=n*n*n%e,u=l*l*n%e,h=en(u,t,e)*u%e,d=en(h,t,e)*u%e,f=en(d,xn,e)*l%e,p=en(f,i,e)*f%e,y=en(p,o,e)*p%e,g=en(y,a,e)*y%e,w=en(g,c,e)*g%e,b=en(w,a,e)*y%e,m=en(b,t,e)*u%e,v=en(m,s,e)*p%e,E=en(v,r,e)*l%e,x=en(E,xn,e);if(!Bn.eql(Bn.sqr(x),n))throw new Error("Cannot find square root");return x}const Bn=function(n,e,t=!1,r={}){if(n<=V)throw new Error(`Expected Fp ORDER > 0, got ${n}`);const{nBitLength:i,nByteLength:o}=on(n,e);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=function(n){if(n%J===W){const e=(n+Z)/J;return function(n,t){const r=n.pow(t,e);if(!n.eql(n.sqr(r),t))throw new Error("Cannot find square root");return r}}if(n%Q===Y){const e=(n-Y)/Q;return function(n,t){const r=n.mul(t,G),i=n.pow(r,e),o=n.mul(t,i),s=n.mul(n.mul(o,G),i),a=n.mul(o,n.sub(s,n.ONE));if(!n.eql(n.sqr(a),t))throw new Error("Cannot find square root");return a}}return function(n){const e=(n-Z)/G;let t,r,i;for(t=n-Z,r=0;t%G===V;t/=G,r++);for(i=G;i<n&&nn(i,e,n)!==n-Z;i++);if(1===r){const e=(n+Z)/J;return function(n,t){const r=n.pow(t,e);if(!n.eql(n.sqr(r),t))throw new Error("Cannot find square root");return r}}const o=(t+Z)/G;return function(n,s){if(n.pow(s,e)===n.neg(n.ONE))throw new Error("Cannot find square root");let a=r,c=n.pow(n.mul(n.ONE,i),t),l=n.pow(s,o),u=n.pow(s,t);for(;!n.eql(u,n.ONE);){if(n.eql(u,n.ZERO))return n.ZERO;let e=1;for(let t=n.sqr(u);e<a&&!n.eql(t,n.ONE);e++)t=n.sqr(t);const t=n.pow(c,Z<<BigInt(a-e-1));c=n.sqr(t),l=n.mul(l,t),u=n.mul(u,c),a=e}return l}}(n)}(n),a=Object.freeze({ORDER:n,BITS:i,BYTES:o,MASK:q(i),ZERO:V,ONE:Z,create:e=>X(e,n),isValid:e=>{if("bigint"!=typeof e)throw new Error("Invalid field element: expected bigint, got "+typeof e);return V<=e&&e<n},is0:n=>n===V,isOdd:n=>(n&Z)===Z,neg:e=>X(-e,n),eql:(n,e)=>n===e,sqr:e=>X(e*e,n),add:(e,t)=>X(e+t,n),sub:(e,t)=>X(e-t,n),mul:(e,t)=>X(e*t,n),pow:(n,e)=>function(n,e,t){if(t<V)throw new Error("Expected power > 0");if(t===V)return n.ONE;if(t===Z)return e;let r=n.ONE,i=e;for(;t>V;)t&Z&&(r=n.mul(r,i)),i=n.sqr(i),t>>=Z;return r}(a,n,e),div:(e,t)=>X(e*tn(t,n),n),sqrN:n=>n*n,addN:(n,e)=>n+e,subN:(n,e)=>n-e,mulN:(n,e)=>n*e,inv:e=>tn(e,n),sqrt:r.sqrt||(n=>s(a,n)),invertBatch:n=>function(n,e){const t=new Array(e.length),r=e.reduce(((e,r,i)=>n.is0(r)?e:(t[i]=e,n.mul(e,r))),n.ONE),i=n.inv(r);return e.reduceRight(((e,r,i)=>n.is0(r)?e:(t[i]=n.mul(e,t[i]),n.mul(e,r))),i),t}(a,n),cmov:(n,e,t)=>t?e:n,toBytes:n=>t?K(n,o):R(n,o),fromBytes:n=>{if(n.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${n.length}`);return t?N(n):T(n)}});return Object.freeze(a)}(mn,void 0,void 0,{sqrt:An}),Sn=function(n,e){const t=e=>yn({...n,...bn(e)});return Object.freeze({...t(e),create:t})}({a:BigInt(0),b:BigInt(7),Fp:Bn,n:vn,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{const e=vn,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-En*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=t,s=BigInt("0x100000000000000000000000000000000"),a=kn(o*n,e),c=kn(-r*n,e);let l=X(n-a*t-c*i,e),u=X(-a*r-c*o,e);const h=l>s,d=u>s;if(h&&(l=e-l),d&&(u=e-u),l>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:h,k1:l,k2neg:d,k2:u}}}},S),In=BigInt(0),Ln=n=>"bigint"==typeof n&&In<n&&n<mn,Un={};function Cn(n,...e){let t=Un[n];if(void 0===t){const e=S(Uint8Array.from(n,(n=>n.charCodeAt(0))));t=H(e,e),Un[n]=t}return S(H(t,...e))}const On=n=>n.toRawBytes(!0).slice(1),$n=n=>R(n,32),_n=n=>X(n,mn),Tn=n=>X(n,vn),Nn=Sn.ProjectivePoint;function Rn(n){let e=Sn.utils.normPrivateKeyToScalar(n),t=Nn.fromPrivateKey(e);return{scalar:t.hasEvenY()?e:Tn(-e),bytes:On(t)}}function Kn(n){if(!Ln(n))throw new Error("bad x: need 0 < x < p");const e=_n(n*n);let t=An(_n(e*n+BigInt(7)));t%xn!==In&&(t=_n(-t));const r=new Nn(n,t,En);return r.assertValidity(),r}function jn(...n){return Tn(T(Cn("BIP0340/challenge",...n)))}function Hn(n){return Rn(n).bytes}function qn(n,e,t=b(32)){const r=j("message",n),{bytes:i,scalar:o}=Rn(e),s=j("auxRand",t,32),a=$n(o^T(Cn("BIP0340/aux",s))),c=Cn("BIP0340/nonce",a,i,r),l=Tn(T(c));if(l===In)throw new Error("sign failed: k is zero");const{bytes:u,scalar:h}=Rn(l),d=jn(u,i,r),f=new Uint8Array(64);if(f.set(u,0),f.set($n(Tn(h+d*o)),32),!Pn(f,r,i))throw new Error("sign: Invalid signature produced");return f}function Pn(n,e,t){const r=j("signature",n,64),i=j("message",e),o=j("publicKey",t,32);try{const n=Kn(T(o)),e=T(r.subarray(0,32));if(!Ln(e))return!1;const t=T(r.subarray(32,64));if(!("bigint"==typeof(l=t)&&In<l&&l<vn))return!1;const u=jn($n(e),On(n),i),h=(s=n,a=t,c=Tn(-u),Nn.BASE.multiplyAndAddUnsafe(s,a,c));return!(!h||!h.hasEvenY()||h.toAffine().x!==e)}catch(n){return!1}var s,a,c,l}const zn=(()=>({getPublicKey:Hn,sign:qn,verify:Pn,utils:{randomPrivateKey:Sn.utils.randomPrivateKey,lift_x:Kn,pointToBytes:On,numberToBytesBE:R,bytesToNumberBE:T,taggedHash:Cn,mod:X}}))();function Fn(n){if(!Number.isSafeInteger(n))throw new Error(`Wrong integer: ${n}`)}function Mn(...n){const e=(n,e)=>t=>n(e(t));return{encode:Array.from(n).reverse().reduce(((n,t)=>n?e(n,t.encode):t.encode),void 0),decode:n.reduce(((n,t)=>n?e(n,t.decode):t.decode),void 0)}}function Dn(n){return{encode:e=>{if(!Array.isArray(e)||e.length&&"number"!=typeof e[0])throw new Error("alphabet.encode input should be an array of numbers");return e.map((e=>{if(Fn(e),e<0||e>=n.length)throw new Error(`Digit index outside alphabet: ${e} (alphabet: ${n.length})`);return n[e]}))},decode:e=>{if(!Array.isArray(e)||e.length&&"string"!=typeof e[0])throw new Error("alphabet.decode input should be array of strings");return e.map((e=>{if("string"!=typeof e)throw new Error(`alphabet.decode: not string element=${e}`);const t=n.indexOf(e);if(-1===t)throw new Error(`Unknown letter: "${e}". Allowed: ${n}`);return t}))}}}function Vn(n=""){if("string"!=typeof n)throw new Error("join separator should be string");return{encode:e=>{if(!Array.isArray(e)||e.length&&"string"!=typeof e[0])throw new Error("join.encode input should be array of strings");for(let n of e)if("string"!=typeof n)throw new Error(`join.encode: non-string input=${n}`);return e.join(n)},decode:e=>{if("string"!=typeof e)throw new Error("join.decode input should be string");return e.split(n)}}}function Zn(n,e="="){if(Fn(n),"string"!=typeof e)throw new Error("padding chr should be string");return{encode(t){if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("padding.encode input should be array of strings");for(let n of t)if("string"!=typeof n)throw new Error(`padding.encode: non-string input=${n}`);for(;t.length*n%8;)t.push(e);return t},decode(t){if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("padding.encode input should be array of strings");for(let n of t)if("string"!=typeof n)throw new Error(`padding.decode: non-string input=${n}`);let r=t.length;if(r*n%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&t[r-1]===e;r--)if(!((r-1)*n%8))throw new Error("Invalid padding: string has too much padding");return t.slice(0,r)}}}function Gn(n){if("function"!=typeof n)throw new Error("normalize fn should be function");return{encode:n=>n,decode:e=>n(e)}}function Wn(n,e,t){if(e<2)throw new Error(`convertRadix: wrong from=${e}, base cannot be less than 2`);if(t<2)throw new Error(`convertRadix: wrong to=${t}, base cannot be less than 2`);if(!Array.isArray(n))throw new Error("convertRadix: data should be array");if(!n.length)return[];let r=0;const i=[],o=Array.from(n);for(o.forEach((n=>{if(Fn(n),n<0||n>=e)throw new Error(`Wrong integer: ${n}`)}));;){let n=0,s=!0;for(let i=r;i<o.length;i++){const a=o[i],c=e*n+a;if(!Number.isSafeInteger(c)||e*n/e!==n||c-a!=e*n)throw new Error("convertRadix: carry overflow");if(n=c%t,o[i]=Math.floor(c/t),!Number.isSafeInteger(o[i])||o[i]*t+n!==c)throw new Error("convertRadix: carry overflow");s&&(o[i]?s=!1:r=i)}if(i.push(n),s)break}for(let e=0;e<n.length-1&&0===n[e];e++)i.push(0);return i.reverse()}const Jn=(n,e)=>e?Jn(e,n%e):n,Yn=(n,e)=>n+(e-Jn(n,e));function Qn(n,e,t,r){if(!Array.isArray(n))throw new Error("convertRadix2: data should be array");if(e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(t<=0||t>32)throw new Error(`convertRadix2: wrong to=${t}`);if(Yn(e,t)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${t} carryBits=${Yn(e,t)}`);let i=0,o=0;const s=2**t-1,a=[];for(const r of n){if(Fn(r),r>=2**e)throw new Error(`convertRadix2: invalid data word=${r} from=${e}`);if(i=i<<e|r,o+e>32)throw new Error(`convertRadix2: carry overflow pos=${o} from=${e}`);for(o+=e;o>=t;o-=t)a.push((i>>o-t&s)>>>0);i&=2**o-1}if(i=i<<t-o&s,!r&&o>=e)throw new Error("Excess padding");if(!r&&i)throw new Error(`Non-zero padding: ${i}`);return r&&o>0&&a.push(i>>>0),a}function Xn(n){return Fn(n),{encode:e=>{if(!(e instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return Wn(Array.from(e),256,n)},decode:e=>{if(!Array.isArray(e)||e.length&&"number"!=typeof e[0])throw new Error("radix.decode input should be array of strings");return Uint8Array.from(Wn(e,n,256))}}}function ne(n,e=!1){if(Fn(n),n<=0||n>32)throw new Error("radix2: bits should be in (0..32]");if(Yn(8,n)>32||Yn(n,8)>32)throw new Error("radix2: carry overflow");return{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return Qn(Array.from(t),8,n,!e)},decode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(Qn(t,n,8,e))}}}function ee(n){if("function"!=typeof n)throw new Error("unsafeWrapper fn should be function");return function(...e){try{return n.apply(null,e)}catch(n){}}}function te(n,e){if(Fn(n),"function"!=typeof e)throw new Error("checksum fn should be function");return{encode(t){if(!(t instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const r=e(t).slice(0,n),i=new Uint8Array(t.length+n);return i.set(t),i.set(r,t.length),i},decode(t){if(!(t instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const r=t.slice(0,-n),i=e(r).slice(0,n),o=t.slice(-n);for(let e=0;e<n;e++)if(i[e]!==o[e])throw new Error("Invalid checksum");return r}}}const re={alphabet:Dn,chain:Mn,checksum:te,radix:Xn,radix2:ne,join:Vn,padding:Zn},ie=(Mn(ne(4),Dn("0123456789ABCDEF"),Vn("")),Mn(ne(5),Dn("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Zn(5),Vn("")),Mn(ne(5),Dn("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Zn(5),Vn("")),Mn(ne(5),Dn("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),Vn(""),Gn((n=>n.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")))),Mn(ne(6),Dn("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Zn(6),Vn(""))),oe=(Mn(ne(6),Dn("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Zn(6),Vn("")),n=>Mn(Xn(58),Dn(n),Vn(""))),se=oe("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),ae=(oe("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),oe("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz"),Mn(Dn("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Vn(""))),ce=[996825010,642813549,513874426,1027748829,705979059];function le(n){const e=n>>25;let t=(33554431&n)<<5;for(let n=0;n<ce.length;n++)1==(e>>n&1)&&(t^=ce[n]);return t}function ue(n,e,t=1){const r=n.length;let i=1;for(let e=0;e<r;e++){const t=n.charCodeAt(e);if(t<33||t>126)throw new Error(`Invalid prefix (${n})`);i=le(i)^t>>5}i=le(i);for(let e=0;e<r;e++)i=le(i)^31&n.charCodeAt(e);for(let n of e)i=le(i)^n;for(let n=0;n<6;n++)i=le(i);return i^=t,ae.encode(Qn([i%2**30],30,5,!1))}function he(n){const e="bech32"===n?1:734539939,t=ne(5),r=t.decode,i=t.encode,o=ee(r);function s(n,t=90){if("string"!=typeof n)throw new Error("bech32.decode input should be string, not "+typeof n);if(n.length<8||!1!==t&&n.length>t)throw new TypeError(`Wrong string length: ${n.length} (${n}). Expected (8..${t})`);const r=n.toLowerCase();if(n!==r&&n!==n.toUpperCase())throw new Error("String must be lowercase or uppercase");const i=(n=r).lastIndexOf("1");if(0===i||-1===i)throw new Error('Letter "1" must be present between prefix and data only');const o=n.slice(0,i),s=n.slice(i+1);if(s.length<6)throw new Error("Data must be at least 6 characters long");const a=ae.decode(s).slice(0,-6),c=ue(o,a,e);if(!s.endsWith(c))throw new Error(`Invalid checksum in ${n}: expected "${c}"`);return{prefix:o,words:a}}return{encode:function(n,t,r=90){if("string"!=typeof n)throw new Error("bech32.encode prefix should be string, not "+typeof n);if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("bech32.encode words should be array of numbers, not "+typeof t);const i=n.length+7+t.length;if(!1!==r&&i>r)throw new TypeError(`Length ${i} exceeds limit ${r}`);return`${n=n.toLowerCase()}1${ae.encode(t)}${ue(n,t,e)}`},decode:s,decodeToBytes:function(n){const{prefix:e,words:t}=s(n,!1);return{prefix:e,words:t,bytes:r(t)}},decodeUnsafe:ee(s),fromWords:r,fromWordsUnsafe:o,toWords:i}}const de=he("bech32"),fe=(he("bech32m"),Mn(ne(4),Dn("0123456789abcdef"),Vn(""),Gn((n=>{if("string"!=typeof n||n.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof n} with length ${n.length}`);return n.toLowerCase()}))),"abandon\nability\nable\nabout\nabove\nabsent\nabsorb\nabstract\nabsurd\nabuse\naccess\naccident\naccount\naccuse\nachieve\nacid\nacoustic\nacquire\nacross\nact\naction\nactor\nactress\nactual\nadapt\nadd\naddict\naddress\nadjust\nadmit\nadult\nadvance\nadvice\naerobic\naffair\nafford\nafraid\nagain\nage\nagent\nagree\nahead\naim\nair\nairport\naisle\nalarm\nalbum\nalcohol\nalert\nalien\nall\nalley\nallow\nalmost\nalone\nalpha\nalready\nalso\nalter\nalways\namateur\namazing\namong\namount\namused\nanalyst\nanchor\nancient\nanger\nangle\nangry\nanimal\nankle\nannounce\nannual\nanother\nanswer\nantenna\nantique\nanxiety\nany\napart\napology\nappear\napple\napprove\napril\narch\narctic\narea\narena\nargue\narm\narmed\narmor\narmy\naround\narrange\narrest\narrive\narrow\nart\nartefact\nartist\nartwork\nask\naspect\nassault\nasset\nassist\nassume\nasthma\nathlete\natom\nattack\nattend\nattitude\nattract\nauction\naudit\naugust\naunt\nauthor\nauto\nautumn\naverage\navocado\navoid\nawake\naware\naway\nawesome\nawful\nawkward\naxis\nbaby\nbachelor\nbacon\nbadge\nbag\nbalance\nbalcony\nball\nbamboo\nbanana\nbanner\nbar\nbarely\nbargain\nbarrel\nbase\nbasic\nbasket\nbattle\nbeach\nbean\nbeauty\nbecause\nbecome\nbeef\nbefore\nbegin\nbehave\nbehind\nbelieve\nbelow\nbelt\nbench\nbenefit\nbest\nbetray\nbetter\nbetween\nbeyond\nbicycle\nbid\nbike\nbind\nbiology\nbird\nbirth\nbitter\nblack\nblade\nblame\nblanket\nblast\nbleak\nbless\nblind\nblood\nblossom\nblouse\nblue\nblur\nblush\nboard\nboat\nbody\nboil\nbomb\nbone\nbonus\nbook\nboost\nborder\nboring\nborrow\nboss\nbottom\nbounce\nbox\nboy\nbracket\nbrain\nbrand\nbrass\nbrave\nbread\nbreeze\nbrick\nbridge\nbrief\nbright\nbring\nbrisk\nbroccoli\nbroken\nbronze\nbroom\nbrother\nbrown\nbrush\nbubble\nbuddy\nbudget\nbuffalo\nbuild\nbulb\nbulk\nbullet\nbundle\nbunker\nburden\nburger\nburst\nbus\nbusiness\nbusy\nbutter\nbuyer\nbuzz\ncabbage\ncabin\ncable\ncactus\ncage\ncake\ncall\ncalm\ncamera\ncamp\ncan\ncanal\ncancel\ncandy\ncannon\ncanoe\ncanvas\ncanyon\ncapable\ncapital\ncaptain\ncar\ncarbon\ncard\ncargo\ncarpet\ncarry\ncart\ncase\ncash\ncasino\ncastle\ncasual\ncat\ncatalog\ncatch\ncategory\ncattle\ncaught\ncause\ncaution\ncave\nceiling\ncelery\ncement\ncensus\ncentury\ncereal\ncertain\nchair\nchalk\nchampion\nchange\nchaos\nchapter\ncharge\nchase\nchat\ncheap\ncheck\ncheese\nchef\ncherry\nchest\nchicken\nchief\nchild\nchimney\nchoice\nchoose\nchronic\nchuckle\nchunk\nchurn\ncigar\ncinnamon\ncircle\ncitizen\ncity\ncivil\nclaim\nclap\nclarify\nclaw\nclay\nclean\nclerk\nclever\nclick\nclient\ncliff\nclimb\nclinic\nclip\nclock\nclog\nclose\ncloth\ncloud\nclown\nclub\nclump\ncluster\nclutch\ncoach\ncoast\ncoconut\ncode\ncoffee\ncoil\ncoin\ncollect\ncolor\ncolumn\ncombine\ncome\ncomfort\ncomic\ncommon\ncompany\nconcert\nconduct\nconfirm\ncongress\nconnect\nconsider\ncontrol\nconvince\ncook\ncool\ncopper\ncopy\ncoral\ncore\ncorn\ncorrect\ncost\ncotton\ncouch\ncountry\ncouple\ncourse\ncousin\ncover\ncoyote\ncrack\ncradle\ncraft\ncram\ncrane\ncrash\ncrater\ncrawl\ncrazy\ncream\ncredit\ncreek\ncrew\ncricket\ncrime\ncrisp\ncritic\ncrop\ncross\ncrouch\ncrowd\ncrucial\ncruel\ncruise\ncrumble\ncrunch\ncrush\ncry\ncrystal\ncube\nculture\ncup\ncupboard\ncurious\ncurrent\ncurtain\ncurve\ncushion\ncustom\ncute\ncycle\ndad\ndamage\ndamp\ndance\ndanger\ndaring\ndash\ndaughter\ndawn\nday\ndeal\ndebate\ndebris\ndecade\ndecember\ndecide\ndecline\ndecorate\ndecrease\ndeer\ndefense\ndefine\ndefy\ndegree\ndelay\ndeliver\ndemand\ndemise\ndenial\ndentist\ndeny\ndepart\ndepend\ndeposit\ndepth\ndeputy\nderive\ndescribe\ndesert\ndesign\ndesk\ndespair\ndestroy\ndetail\ndetect\ndevelop\ndevice\ndevote\ndiagram\ndial\ndiamond\ndiary\ndice\ndiesel\ndiet\ndiffer\ndigital\ndignity\ndilemma\ndinner\ndinosaur\ndirect\ndirt\ndisagree\ndiscover\ndisease\ndish\ndismiss\ndisorder\ndisplay\ndistance\ndivert\ndivide\ndivorce\ndizzy\ndoctor\ndocument\ndog\ndoll\ndolphin\ndomain\ndonate\ndonkey\ndonor\ndoor\ndose\ndouble\ndove\ndraft\ndragon\ndrama\ndrastic\ndraw\ndream\ndress\ndrift\ndrill\ndrink\ndrip\ndrive\ndrop\ndrum\ndry\nduck\ndumb\ndune\nduring\ndust\ndutch\nduty\ndwarf\ndynamic\neager\neagle\nearly\nearn\nearth\neasily\neast\neasy\necho\necology\neconomy\nedge\nedit\neducate\neffort\negg\neight\neither\nelbow\nelder\nelectric\nelegant\nelement\nelephant\nelevator\nelite\nelse\nembark\nembody\nembrace\nemerge\nemotion\nemploy\nempower\nempty\nenable\nenact\nend\nendless\nendorse\nenemy\nenergy\nenforce\nengage\nengine\nenhance\nenjoy\nenlist\nenough\nenrich\nenroll\nensure\nenter\nentire\nentry\nenvelope\nepisode\nequal\nequip\nera\nerase\nerode\nerosion\nerror\nerupt\nescape\nessay\nessence\nestate\neternal\nethics\nevidence\nevil\nevoke\nevolve\nexact\nexample\nexcess\nexchange\nexcite\nexclude\nexcuse\nexecute\nexercise\nexhaust\nexhibit\nexile\nexist\nexit\nexotic\nexpand\nexpect\nexpire\nexplain\nexpose\nexpress\nextend\nextra\neye\neyebrow\nfabric\nface\nfaculty\nfade\nfaint\nfaith\nfall\nfalse\nfame\nfamily\nfamous\nfan\nfancy\nfantasy\nfarm\nfashion\nfat\nfatal\nfather\nfatigue\nfault\nfavorite\nfeature\nfebruary\nfederal\nfee\nfeed\nfeel\nfemale\nfence\nfestival\nfetch\nfever\nfew\nfiber\nfiction\nfield\nfigure\nfile\nfilm\nfilter\nfinal\nfind\nfine\nfinger\nfinish\nfire\nfirm\nfirst\nfiscal\nfish\nfit\nfitness\nfix\nflag\nflame\nflash\nflat\nflavor\nflee\nflight\nflip\nfloat\nflock\nfloor\nflower\nfluid\nflush\nfly\nfoam\nfocus\nfog\nfoil\nfold\nfollow\nfood\nfoot\nforce\nforest\nforget\nfork\nfortune\nforum\nforward\nfossil\nfoster\nfound\nfox\nfragile\nframe\nfrequent\nfresh\nfriend\nfringe\nfrog\nfront\nfrost\nfrown\nfrozen\nfruit\nfuel\nfun\nfunny\nfurnace\nfury\nfuture\ngadget\ngain\ngalaxy\ngallery\ngame\ngap\ngarage\ngarbage\ngarden\ngarlic\ngarment\ngas\ngasp\ngate\ngather\ngauge\ngaze\ngeneral\ngenius\ngenre\ngentle\ngenuine\ngesture\nghost\ngiant\ngift\ngiggle\nginger\ngiraffe\ngirl\ngive\nglad\nglance\nglare\nglass\nglide\nglimpse\nglobe\ngloom\nglory\nglove\nglow\nglue\ngoat\ngoddess\ngold\ngood\ngoose\ngorilla\ngospel\ngossip\ngovern\ngown\ngrab\ngrace\ngrain\ngrant\ngrape\ngrass\ngravity\ngreat\ngreen\ngrid\ngrief\ngrit\ngrocery\ngroup\ngrow\ngrunt\nguard\nguess\nguide\nguilt\nguitar\ngun\ngym\nhabit\nhair\nhalf\nhammer\nhamster\nhand\nhappy\nharbor\nhard\nharsh\nharvest\nhat\nhave\nhawk\nhazard\nhead\nhealth\nheart\nheavy\nhedgehog\nheight\nhello\nhelmet\nhelp\nhen\nhero\nhidden\nhigh\nhill\nhint\nhip\nhire\nhistory\nhobby\nhockey\nhold\nhole\nholiday\nhollow\nhome\nhoney\nhood\nhope\nhorn\nhorror\nhorse\nhospital\nhost\nhotel\nhour\nhover\nhub\nhuge\nhuman\nhumble\nhumor\nhundred\nhungry\nhunt\nhurdle\nhurry\nhurt\nhusband\nhybrid\nice\nicon\nidea\nidentify\nidle\nignore\nill\nillegal\nillness\nimage\nimitate\nimmense\nimmune\nimpact\nimpose\nimprove\nimpulse\ninch\ninclude\nincome\nincrease\nindex\nindicate\nindoor\nindustry\ninfant\ninflict\ninform\ninhale\ninherit\ninitial\ninject\ninjury\ninmate\ninner\ninnocent\ninput\ninquiry\ninsane\ninsect\ninside\ninspire\ninstall\nintact\ninterest\ninto\ninvest\ninvite\ninvolve\niron\nisland\nisolate\nissue\nitem\nivory\njacket\njaguar\njar\njazz\njealous\njeans\njelly\njewel\njob\njoin\njoke\njourney\njoy\njudge\njuice\njump\njungle\njunior\njunk\njust\nkangaroo\nkeen\nkeep\nketchup\nkey\nkick\nkid\nkidney\nkind\nkingdom\nkiss\nkit\nkitchen\nkite\nkitten\nkiwi\nknee\nknife\nknock\nknow\nlab\nlabel\nlabor\nladder\nlady\nlake\nlamp\nlanguage\nlaptop\nlarge\nlater\nlatin\nlaugh\nlaundry\nlava\nlaw\nlawn\nlawsuit\nlayer\nlazy\nleader\nleaf\nlearn\nleave\nlecture\nleft\nleg\nlegal\nlegend\nleisure\nlemon\nlend\nlength\nlens\nleopard\nlesson\nletter\nlevel\nliar\nliberty\nlibrary\nlicense\nlife\nlift\nlight\nlike\nlimb\nlimit\nlink\nlion\nliquid\nlist\nlittle\nlive\nlizard\nload\nloan\nlobster\nlocal\nlock\nlogic\nlonely\nlong\nloop\nlottery\nloud\nlounge\nlove\nloyal\nlucky\nluggage\nlumber\nlunar\nlunch\nluxury\nlyrics\nmachine\nmad\nmagic\nmagnet\nmaid\nmail\nmain\nmajor\nmake\nmammal\nman\nmanage\nmandate\nmango\nmansion\nmanual\nmaple\nmarble\nmarch\nmargin\nmarine\nmarket\nmarriage\nmask\nmass\nmaster\nmatch\nmaterial\nmath\nmatrix\nmatter\nmaximum\nmaze\nmeadow\nmean\nmeasure\nmeat\nmechanic\nmedal\nmedia\nmelody\nmelt\nmember\nmemory\nmention\nmenu\nmercy\nmerge\nmerit\nmerry\nmesh\nmessage\nmetal\nmethod\nmiddle\nmidnight\nmilk\nmillion\nmimic\nmind\nminimum\nminor\nminute\nmiracle\nmirror\nmisery\nmiss\nmistake\nmix\nmixed\nmixture\nmobile\nmodel\nmodify\nmom\nmoment\nmonitor\nmonkey\nmonster\nmonth\nmoon\nmoral\nmore\nmorning\nmosquito\nmother\nmotion\nmotor\nmountain\nmouse\nmove\nmovie\nmuch\nmuffin\nmule\nmultiply\nmuscle\nmuseum\nmushroom\nmusic\nmust\nmutual\nmyself\nmystery\nmyth\nnaive\nname\nnapkin\nnarrow\nnasty\nnation\nnature\nnear\nneck\nneed\nnegative\nneglect\nneither\nnephew\nnerve\nnest\nnet\nnetwork\nneutral\nnever\nnews\nnext\nnice\nnight\nnoble\nnoise\nnominee\nnoodle\nnormal\nnorth\nnose\nnotable\nnote\nnothing\nnotice\nnovel\nnow\nnuclear\nnumber\nnurse\nnut\noak\nobey\nobject\noblige\nobscure\nobserve\nobtain\nobvious\noccur\nocean\noctober\nodor\noff\noffer\noffice\noften\noil\nokay\nold\nolive\nolympic\nomit\nonce\none\nonion\nonline\nonly\nopen\nopera\nopinion\noppose\noption\norange\norbit\norchard\norder\nordinary\norgan\norient\noriginal\norphan\nostrich\nother\noutdoor\nouter\noutput\noutside\noval\noven\nover\nown\nowner\noxygen\noyster\nozone\npact\npaddle\npage\npair\npalace\npalm\npanda\npanel\npanic\npanther\npaper\nparade\nparent\npark\nparrot\nparty\npass\npatch\npath\npatient\npatrol\npattern\npause\npave\npayment\npeace\npeanut\npear\npeasant\npelican\npen\npenalty\npencil\npeople\npepper\nperfect\npermit\nperson\npet\nphone\nphoto\nphrase\nphysical\npiano\npicnic\npicture\npiece\npig\npigeon\npill\npilot\npink\npioneer\npipe\npistol\npitch\npizza\nplace\nplanet\nplastic\nplate\nplay\nplease\npledge\npluck\nplug\nplunge\npoem\npoet\npoint\npolar\npole\npolice\npond\npony\npool\npopular\nportion\nposition\npossible\npost\npotato\npottery\npoverty\npowder\npower\npractice\npraise\npredict\nprefer\nprepare\npresent\npretty\nprevent\nprice\npride\nprimary\nprint\npriority\nprison\nprivate\nprize\nproblem\nprocess\nproduce\nprofit\nprogram\nproject\npromote\nproof\nproperty\nprosper\nprotect\nproud\nprovide\npublic\npudding\npull\npulp\npulse\npumpkin\npunch\npupil\npuppy\npurchase\npurity\npurpose\npurse\npush\nput\npuzzle\npyramid\nquality\nquantum\nquarter\nquestion\nquick\nquit\nquiz\nquote\nrabbit\nraccoon\nrace\nrack\nradar\nradio\nrail\nrain\nraise\nrally\nramp\nranch\nrandom\nrange\nrapid\nrare\nrate\nrather\nraven\nraw\nrazor\nready\nreal\nreason\nrebel\nrebuild\nrecall\nreceive\nrecipe\nrecord\nrecycle\nreduce\nreflect\nreform\nrefuse\nregion\nregret\nregular\nreject\nrelax\nrelease\nrelief\nrely\nremain\nremember\nremind\nremove\nrender\nrenew\nrent\nreopen\nrepair\nrepeat\nreplace\nreport\nrequire\nrescue\nresemble\nresist\nresource\nresponse\nresult\nretire\nretreat\nreturn\nreunion\nreveal\nreview\nreward\nrhythm\nrib\nribbon\nrice\nrich\nride\nridge\nrifle\nright\nrigid\nring\nriot\nripple\nrisk\nritual\nrival\nriver\nroad\nroast\nrobot\nrobust\nrocket\nromance\nroof\nrookie\nroom\nrose\nrotate\nrough\nround\nroute\nroyal\nrubber\nrude\nrug\nrule\nrun\nrunway\nrural\nsad\nsaddle\nsadness\nsafe\nsail\nsalad\nsalmon\nsalon\nsalt\nsalute\nsame\nsample\nsand\nsatisfy\nsatoshi\nsauce\nsausage\nsave\nsay\nscale\nscan\nscare\nscatter\nscene\nscheme\nschool\nscience\nscissors\nscorpion\nscout\nscrap\nscreen\nscript\nscrub\nsea\nsearch\nseason\nseat\nsecond\nsecret\nsection\nsecurity\nseed\nseek\nsegment\nselect\nsell\nseminar\nsenior\nsense\nsentence\nseries\nservice\nsession\nsettle\nsetup\nseven\nshadow\nshaft\nshallow\nshare\nshed\nshell\nsheriff\nshield\nshift\nshine\nship\nshiver\nshock\nshoe\nshoot\nshop\nshort\nshoulder\nshove\nshrimp\nshrug\nshuffle\nshy\nsibling\nsick\nside\nsiege\nsight\nsign\nsilent\nsilk\nsilly\nsilver\nsimilar\nsimple\nsince\nsing\nsiren\nsister\nsituate\nsix\nsize\nskate\nsketch\nski\nskill\nskin\nskirt\nskull\nslab\nslam\nsleep\nslender\nslice\nslide\nslight\nslim\nslogan\nslot\nslow\nslush\nsmall\nsmart\nsmile\nsmoke\nsmooth\nsnack\nsnake\nsnap\nsniff\nsnow\nsoap\nsoccer\nsocial\nsock\nsoda\nsoft\nsolar\nsoldier\nsolid\nsolution\nsolve\nsomeone\nsong\nsoon\nsorry\nsort\nsoul\nsound\nsoup\nsource\nsouth\nspace\nspare\nspatial\nspawn\nspeak\nspecial\nspeed\nspell\nspend\nsphere\nspice\nspider\nspike\nspin\nspirit\nsplit\nspoil\nsponsor\nspoon\nsport\nspot\nspray\nspread\nspring\nspy\nsquare\nsqueeze\nsquirrel\nstable\nstadium\nstaff\nstage\nstairs\nstamp\nstand\nstart\nstate\nstay\nsteak\nsteel\nstem\nstep\nstereo\nstick\nstill\nsting\nstock\nstomach\nstone\nstool\nstory\nstove\nstrategy\nstreet\nstrike\nstrong\nstruggle\nstudent\nstuff\nstumble\nstyle\nsubject\nsubmit\nsubway\nsuccess\nsuch\nsudden\nsuffer\nsugar\nsuggest\nsuit\nsummer\nsun\nsunny\nsunset\nsuper\nsupply\nsupreme\nsure\nsurface\nsurge\nsurprise\nsurround\nsurvey\nsuspect\nsustain\nswallow\nswamp\nswap\nswarm\nswear\nsweet\nswift\nswim\nswing\nswitch\nsword\nsymbol\nsymptom\nsyrup\nsystem\ntable\ntackle\ntag\ntail\ntalent\ntalk\ntank\ntape\ntarget\ntask\ntaste\ntattoo\ntaxi\nteach\nteam\ntell\nten\ntenant\ntennis\ntent\nterm\ntest\ntext\nthank\nthat\ntheme\nthen\ntheory\nthere\nthey\nthing\nthis\nthought\nthree\nthrive\nthrow\nthumb\nthunder\nticket\ntide\ntiger\ntilt\ntimber\ntime\ntiny\ntip\ntired\ntissue\ntitle\ntoast\ntobacco\ntoday\ntoddler\ntoe\ntogether\ntoilet\ntoken\ntomato\ntomorrow\ntone\ntongue\ntonight\ntool\ntooth\ntop\ntopic\ntopple\ntorch\ntornado\ntortoise\ntoss\ntotal\ntourist\ntoward\ntower\ntown\ntoy\ntrack\ntrade\ntraffic\ntragic\ntrain\ntransfer\ntrap\ntrash\ntravel\ntray\ntreat\ntree\ntrend\ntrial\ntribe\ntrick\ntrigger\ntrim\ntrip\ntrophy\ntrouble\ntruck\ntrue\ntruly\ntrumpet\ntrust\ntruth\ntry\ntube\ntuition\ntumble\ntuna\ntunnel\nturkey\nturn\nturtle\ntwelve\ntwenty\ntwice\ntwin\ntwist\ntwo\ntype\ntypical\nugly\numbrella\nunable\nunaware\nuncle\nuncover\nunder\nundo\nunfair\nunfold\nunhappy\nuniform\nunique\nunit\nuniverse\nunknown\nunlock\nuntil\nunusual\nunveil\nupdate\nupgrade\nuphold\nupon\nupper\nupset\nurban\nurge\nusage\nuse\nused\nuseful\nuseless\nusual\nutility\nvacant\nvacuum\nvague\nvalid\nvalley\nvalve\nvan\nvanish\nvapor\nvarious\nvast\nvault\nvehicle\nvelvet\nvendor\nventure\nvenue\nverb\nverify\nversion\nvery\nvessel\nveteran\nviable\nvibrant\nvicious\nvictory\nvideo\nview\nvillage\nvintage\nviolin\nvirtual\nvirus\nvisa\nvisit\nvisual\nvital\nvivid\nvocal\nvoice\nvoid\nvolcano\nvolume\nvote\nvoyage\nwage\nwagon\nwait\nwalk\nwall\nwalnut\nwant\nwarfare\nwarm\nwarrior\nwash\nwasp\nwaste\nwater\nwave\nway\nwealth\nweapon\nwear\nweasel\nweather\nweb\nwedding\nweekend\nweird\nwelcome\nwest\nwet\nwhale\nwhat\nwheat\nwheel\nwhen\nwhere\nwhip\nwhisper\nwide\nwidth\nwife\nwild\nwill\nwin\nwindow\nwine\nwing\nwink\nwinner\nwinter\nwire\nwisdom\nwise\nwish\nwitness\nwolf\nwoman\nwonder\nwood\nwool\nword\nwork\nworld\nworry\nworth\nwrap\nwreck\nwrestle\nwrist\nwrite\nwrong\nyard\nyear\nyellow\nyou\nyoung\nyouth\nzebra\nzero\nzone\nzoo".split("\n"));function pe(n,e,t,r){o.hash(n);const i=function(n,e){if(void 0!==e&&("object"!=typeof e||(t=e,"[object Object]"!==Object.prototype.toString.call(t)||t.constructor!==Object)))throw new Error("Options should be object or undefined");var t;return Object.assign(n,e)}({dkLen:32,asyncTick:10},r),{c:s,dkLen:a,asyncTick:c}=i;if(o.number(s),o.number(a),o.number(c),s<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const l=p(e),u=p(t),h=new Uint8Array(a),d=wn.create(n,l),f=d._cloneInto().update(u);return{c:s,dkLen:a,asyncTick:c,DK:h,PRF:d,PRFSalt:f}}const ye=BigInt(2**32-1),ge=BigInt(32);function we(n,e=!1){return e?{h:Number(n&ye),l:Number(n>>ge&ye)}:{h:0|Number(n>>ge&ye),l:0|Number(n&ye)}}const be=function(n,e=!1){let t=new Uint32Array(n.length),r=new Uint32Array(n.length);for(let i=0;i<n.length;i++){const{h:o,l:s}=we(n[i],e);[t[i],r[i]]=[o,s]}return[t,r]},me=(n,e,t)=>n>>>t,ve=(n,e,t)=>n<<32-t|e>>>t,Ee=(n,e,t)=>n>>>t|e<<32-t,xe=(n,e,t)=>n<<32-t|e>>>t,ke=(n,e,t)=>n<<64-t|e>>>t-32,Ae=(n,e,t)=>n>>>t-32|e<<64-t,Be=function(n,e,t,r){const i=(e>>>0)+(r>>>0);return{h:n+t+(i/2**32|0)|0,l:0|i}},Se=(n,e,t)=>(n>>>0)+(e>>>0)+(t>>>0),Ie=(n,e,t,r)=>e+t+r+(n/2**32|0)|0,Le=(n,e,t,r)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0),Ue=(n,e,t,r,i)=>e+t+r+i+(n/2**32|0)|0,Ce=(n,e,t,r,i,o)=>e+t+r+i+o+(n/2**32|0)|0,Oe=(n,e,t,r,i)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),[$e,_e]=be(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((n=>BigInt(n)))),Te=new Uint32Array(80),Ne=new Uint32Array(80);class Re extends m{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:n,Al:e,Bh:t,Bl:r,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:l,Fh:u,Fl:h,Gh:d,Gl:f,Hh:p,Hl:y}=this;return[n,e,t,r,i,o,s,a,c,l,u,h,d,f,p,y]}set(n,e,t,r,i,o,s,a,c,l,u,h,d,f,p,y){this.Ah=0|n,this.Al=0|e,this.Bh=0|t,this.Bl=0|r,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|l,this.Fh=0|u,this.Fl=0|h,this.Gh=0|d,this.Gl=0|f,this.Hh=0|p,this.Hl=0|y}process(n,e){for(let t=0;t<16;t++,e+=4)Te[t]=n.getUint32(e),Ne[t]=n.getUint32(e+=4);for(let n=16;n<80;n++){const e=0|Te[n-15],t=0|Ne[n-15],r=Ee(e,t,1)^Ee(e,t,8)^me(e,t,7),i=xe(e,t,1)^xe(e,t,8)^ve(e,t,7),o=0|Te[n-2],s=0|Ne[n-2],a=Ee(o,s,19)^ke(o,s,61)^me(o,s,6),c=xe(o,s,19)^Ae(o,s,61)^ve(o,s,6),l=Le(i,c,Ne[n-7],Ne[n-16]),u=Ue(l,r,a,Te[n-7],Te[n-16]);Te[n]=0|u,Ne[n]=0|l}let{Ah:t,Al:r,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:l,Eh:u,El:h,Fh:d,Fl:f,Gh:p,Gl:y,Hh:g,Hl:w}=this;for(let n=0;n<80;n++){const e=Ee(u,h,14)^Ee(u,h,18)^ke(u,h,41),b=xe(u,h,14)^xe(u,h,18)^Ae(u,h,41),m=u&d^~u&p,v=Oe(w,b,h&f^~h&y,_e[n],Ne[n]),E=Ce(v,g,e,m,$e[n],Te[n]),x=0|v,k=Ee(t,r,28)^ke(t,r,34)^ke(t,r,39),A=xe(t,r,28)^Ae(t,r,34)^Ae(t,r,39),B=t&i^t&s^i&s,S=r&o^r&a^o&a;g=0|p,w=0|y,p=0|d,y=0|f,d=0|u,f=0|h,({h:u,l:h}=Be(0|c,0|l,0|E,0|x)),c=0|s,l=0|a,s=0|i,a=0|o,i=0|t,o=0|r;const I=Se(x,A,S);t=Ie(I,E,k,B),r=0|I}({h:t,l:r}=Be(0|this.Ah,0|this.Al,0|t,0|r)),({h:i,l:o}=Be(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=Be(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l}=Be(0|this.Dh,0|this.Dl,0|c,0|l)),({h:u,l:h}=Be(0|this.Eh,0|this.El,0|u,0|h)),({h:d,l:f}=Be(0|this.Fh,0|this.Fl,0|d,0|f)),({h:p,l:y}=Be(0|this.Gh,0|this.Gl,0|p,0|y)),({h:g,l:w}=Be(0|this.Hh,0|this.Hl,0|g,0|w)),this.set(t,r,i,o,s,a,c,l,u,h,d,f,p,y,g,w)}roundClean(){Te.fill(0),Ne.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class Ke extends Re{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}class je extends Re{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class He extends Re{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const qe=w((()=>new Re));function Pe(n){if("string"!=typeof n)throw new TypeError("Invalid mnemonic type: "+typeof n);return n.normalize("NFKD")}function ze(n){const e=Pe(n),t=e.split(" ");if(![12,15,18,21,24].includes(t.length))throw new Error("Invalid mnemonic");return{nfkd:e,words:t}}function Fe(n){o.bytes(n,16,20,24,28,32)}w((()=>new Ke)),w((()=>new je)),w((()=>new He));const Me=n=>{const e=8-n.length/4;return new Uint8Array([S(n)[0]>>e<<e])};function De(n){if(!Array.isArray(n)||2048!==n.length||"string"!=typeof n[0])throw new Error("Worlist: expected array of 2048 strings");return n.forEach((n=>{if("string"!=typeof n)throw new Error(`Wordlist: non-string element: ${n}`)})),re.chain(re.checksum(1,Me),re.radix2(11,!0),re.alphabet(n))}function Ve(n,e=""){return function(n,e,t){const{c:r,dkLen:i,DK:o,PRF:s,PRFSalt:a}=pe(n,e,t,{c:2048,dkLen:64});let l;const u=new Uint8Array(4),h=c(u),d=new Uint8Array(s.outputLen);for(let n=1,e=0;e<i;n++,e+=s.outputLen){const t=o.subarray(e,e+s.outputLen);h.setInt32(0,n,!1),(l=a._cloneInto(l)).update(u).digestInto(d),t.set(d.subarray(0,t.length));for(let n=1;n<r;n++){s._cloneInto(l).update(d).digestInto(d);for(let n=0;n<t.length;n++)t[n]^=d[n]}}return function(n,e,t,r,i){return n.destroy(),e.destroy(),r&&r.destroy(),i.fill(0),t}(s,a,o,l,d)}(qe,ze(n).nfkd,(n=>Pe(`mnemonic${n}`))(e))}const Ze=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Ge=Uint8Array.from({length:16},((n,e)=>e)),We=Ge.map((n=>(9*n+5)%16));let Je=[Ge],Ye=[We];for(let n=0;n<4;n++)for(let e of[Je,Ye])e.push(e[n].map((n=>Ze[n])));const Qe=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map((n=>new Uint8Array(n))),Xe=Je.map(((n,e)=>n.map((n=>Qe[e][n])))),nt=Ye.map(((n,e)=>n.map((n=>Qe[e][n])))),et=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),tt=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),rt=(n,e)=>n<<e|n>>>32-e;function it(n,e,t,r){return 0===n?e^t^r:1===n?e&t|~e&r:2===n?(e|~t)^r:3===n?e&r|t&~r:e^(t|~r)}const ot=new Uint32Array(16);class st extends m{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:n,h1:e,h2:t,h3:r,h4:i}=this;return[n,e,t,r,i]}set(n,e,t,r,i){this.h0=0|n,this.h1=0|e,this.h2=0|t,this.h3=0|r,this.h4=0|i}process(n,e){for(let t=0;t<16;t++,e+=4)ot[t]=n.getUint32(e,!0);let t=0|this.h0,r=t,i=0|this.h1,o=i,s=0|this.h2,a=s,c=0|this.h3,l=c,u=0|this.h4,h=u;for(let n=0;n<5;n++){const e=4-n,d=et[n],f=tt[n],p=Je[n],y=Ye[n],g=Xe[n],w=nt[n];for(let e=0;e<16;e++){const r=rt(t+it(n,i,s,c)+ot[p[e]]+d,g[e])+u|0;t=u,u=c,c=0|rt(s,10),s=i,i=r}for(let n=0;n<16;n++){const t=rt(r+it(e,o,a,l)+ot[y[n]]+f,w[n])+h|0;r=h,h=l,l=0|rt(a,10),a=o,o=t}}this.set(this.h1+s+l|0,this.h2+c+h|0,this.h3+u+r|0,this.h4+t+o|0,this.h0+i+a|0)}roundClean(){ot.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const at=w((()=>new st)),ct=Sn.ProjectivePoint,lt=(ut=S,Mn(te(4,(n=>ut(ut(n)))),se));var ut;function ht(n){return BigInt(`0x${h(n)}`)}const dt=f("Bitcoin seed"),ft={private:76066276,public:76067358},pt=2147483648,yt=n=>{if(!Number.isSafeInteger(n)||n<0||n>2**32-1)throw new Error(`Invalid number=${n}. Should be from 0 to 2 ** 32 - 1`);const e=new Uint8Array(4);return c(e).setUint32(0,n,!1),e};class gt{get fingerprint(){if(!this.pubHash)throw new Error("No publicKey set!");return n=this.pubHash,c(n).getUint32(0,!1);var n}get identifier(){return this.pubHash}get pubKeyHash(){return this.pubHash}get privateKey(){return this.privKeyBytes||null}get publicKey(){return this.pubKey||null}get privateExtendedKey(){const n=this.privateKey;if(!n)throw new Error("No private key");return lt.encode(this.serialize(this.versions.private,y(new Uint8Array([0]),n)))}get publicExtendedKey(){if(!this.pubKey)throw new Error("No public key");return lt.encode(this.serialize(this.versions.public,this.pubKey))}static fromMasterSeed(n,e=ft){if(i(n),8*n.length<128||8*n.length>512)throw new Error(`HDKey: wrong seed length=${n.length}. Should be between 128 and 512 bits; 256 bits is advised)`);const t=wn(qe,dt,n);return new gt({versions:e,chainCode:t.slice(32),privateKey:t.slice(0,32)})}static fromExtendedKey(n,e=ft){const t=lt.decode(n),r=c(t),i=r.getUint32(0,!1),o={versions:e,depth:t[4],parentFingerprint:r.getUint32(5,!1),index:r.getUint32(9,!1),chainCode:t.slice(13,45)},s=t.slice(45),a=0===s[0];if(i!==e[a?"private":"public"])throw new Error("Version mismatch");return new gt(a?{...o,privateKey:s.slice(1)}:{...o,publicKey:s})}static fromJSON(n){return gt.fromExtendedKey(n.xpriv)}constructor(n){if(this.depth=0,this.index=0,this.chainCode=null,this.parentFingerprint=0,!n||"object"!=typeof n)throw new Error("HDKey.constructor must not be called directly");if(this.versions=n.versions||ft,this.depth=n.depth||0,this.chainCode=n.chainCode,this.index=n.index||0,this.parentFingerprint=n.parentFingerprint||0,!this.depth&&(this.parentFingerprint||this.index))throw new Error("HDKey: zero depth with non-zero index/parent fingerprint");if(n.publicKey&&n.privateKey)throw new Error("HDKey: publicKey and privateKey at same time.");if(n.privateKey){if(!Sn.utils.isValidPrivateKey(n.privateKey))throw new Error("Invalid private key");this.privKey="bigint"==typeof n.privateKey?n.privateKey:ht(n.privateKey),this.privKeyBytes=d(this.privKey.toString(16).padStart(64,"0")),this.pubKey=Sn.getPublicKey(n.privateKey,!0)}else{if(!n.publicKey)throw new Error("HDKey: no public or private key provided");this.pubKey=ct.fromHex(n.publicKey).toRawBytes(!0)}var e;this.pubHash=(e=this.pubKey,at(S(e)))}derive(n){if(!/^[mM]'?/.test(n))throw new Error('Path must start with "m" or "M"');if(/^[mM]'?$/.test(n))return this;const e=n.replace(/^[mM]'?\//,"").split("/");let t=this;for(const n of e){const e=/^(\d+)('?)$/.exec(n);if(!e||3!==e.length)throw new Error(`Invalid child index: ${n}`);let r=+e[1];if(!Number.isSafeInteger(r)||r>=pt)throw new Error("Invalid index");"'"===e[2]&&(r+=pt),t=t.deriveChild(r)}return t}deriveChild(n){if(!this.pubKey||!this.chainCode)throw new Error("No publicKey or chainCode set");let e=yt(n);if(n>=pt){const n=this.privateKey;if(!n)throw new Error("Could not derive hardened child key");e=y(new Uint8Array([0]),n,e)}else e=y(this.pubKey,e);const t=wn(qe,this.chainCode,e),r=ht(t.slice(0,32)),i=t.slice(32);if(!Sn.utils.isValidPrivateKey(r))throw new Error("Tweak bigger than curve order");const o={versions:this.versions,chainCode:i,depth:this.depth+1,parentFingerprint:this.fingerprint,index:n};try{if(this.privateKey){const n=X(this.privKey+r,Sn.CURVE.n);if(!Sn.utils.isValidPrivateKey(n))throw new Error("The tweak was out of range or the resulted private key is invalid");o.privateKey=n}else{const n=ct.fromHex(this.pubKey).add(ct.fromPrivateKey(r));if(n.equals(ct.ZERO))throw new Error("The tweak was equal to negative P, which made the result key invalid");o.publicKey=n.toRawBytes(!0)}return new gt(o)}catch(e){return this.deriveChild(n+1)}}sign(n){if(!this.privateKey)throw new Error("No privateKey set!");return i(n,32),Sn.sign(n,this.privKey).toCompactRawBytes()}verify(n,e){if(i(n,32),i(e,64),!this.publicKey)throw new Error("No publicKey set!");let t;try{t=Sn.Signature.fromCompact(e)}catch(n){return!1}return Sn.verify(t,n,this.publicKey)}wipePrivateData(){return this.privKey=void 0,this.privKeyBytes&&(this.privKeyBytes.fill(0),this.privKeyBytes=void 0),this}toJSON(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}}serialize(n,e){if(!this.chainCode)throw new Error("No chainCode set");return i(e,33),y(yt(n),new Uint8Array([this.depth]),yt(this.parentFingerprint),yt(this.index),this.chainCode,e)}}const wt=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4));if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");function bt(n){if("string"!=typeof n)throw new Error("utf8ToBytes expected string, got "+typeof n);return new Uint8Array((new TextEncoder).encode(n))}function mt(n){if("string"==typeof n&&(n=bt(n)),!(n instanceof Uint8Array))throw new Error("expected Uint8Array, got "+typeof n);return n}function vt(n,e){if(!(n instanceof Uint8Array))throw new Error("Uint8Array expected");if("number"==typeof e&&n.length!==e)throw new Error(`Uint8Array length ${e} expected`)}function Et(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`Wrong positive integer: ${n}`)}function xt(n,...e){if(!(n instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(n.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${n.length}`)}const kt={number:Et,bool:function(n){if("boolean"!=typeof n)throw new Error(`Expected boolean, not ${n}`)},bytes:xt,hash:function(n){if("function"!=typeof n||"function"!=typeof n.create)throw new Error("hash must be wrapped by utils.wrapConstructor");Et(n.outputLen),Et(n.blockLen)},exists:function(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")},output:function(n,e){xt(n);const t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}},At=(n,e)=>255&n[e++]|(255&n[e++])<<8;class Bt{constructor(n){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,vt(n=mt(n),32);const e=At(n,0),t=At(n,2),r=At(n,4),i=At(n,6),o=At(n,8),s=At(n,10),a=At(n,12),c=At(n,14);this.r[0]=8191&e,this.r[1]=8191&(e>>>13|t<<3),this.r[2]=7939&(t>>>10|r<<6),this.r[3]=8191&(r>>>7|i<<9),this.r[4]=255&(i>>>4|o<<12),this.r[5]=o>>>1&8190,this.r[6]=8191&(o>>>14|s<<2),this.r[7]=8065&(s>>>11|a<<5),this.r[8]=8191&(a>>>8|c<<8),this.r[9]=c>>>5&127;for(let e=0;e<8;e++)this.pad[e]=At(n,16+2*e)}process(n,e,t=!1){const r=t?0:2048,{h:i,r:o}=this,s=o[0],a=o[1],c=o[2],l=o[3],u=o[4],h=o[5],d=o[6],f=o[7],p=o[8],y=o[9],g=At(n,e+0),w=At(n,e+2),b=At(n,e+4),m=At(n,e+6),v=At(n,e+8),E=At(n,e+10),x=At(n,e+12),k=At(n,e+14);let A=i[0]+(8191&g),B=i[1]+(8191&(g>>>13|w<<3)),S=i[2]+(8191&(w>>>10|b<<6)),I=i[3]+(8191&(b>>>7|m<<9)),L=i[4]+(8191&(m>>>4|v<<12)),U=i[5]+(v>>>1&8191),C=i[6]+(8191&(v>>>14|E<<2)),O=i[7]+(8191&(E>>>11|x<<5)),$=i[8]+(8191&(x>>>8|k<<8)),_=i[9]+(k>>>5|r),T=0,N=T+A*s+B*(5*y)+S*(5*p)+I*(5*f)+L*(5*d);T=N>>>13,N&=8191,N+=U*(5*h)+C*(5*u)+O*(5*l)+$*(5*c)+_*(5*a),T+=N>>>13,N&=8191;let R=T+A*a+B*s+S*(5*y)+I*(5*p)+L*(5*f);T=R>>>13,R&=8191,R+=U*(5*d)+C*(5*h)+O*(5*u)+$*(5*l)+_*(5*c),T+=R>>>13,R&=8191;let K=T+A*c+B*a+S*s+I*(5*y)+L*(5*p);T=K>>>13,K&=8191,K+=U*(5*f)+C*(5*d)+O*(5*h)+$*(5*u)+_*(5*l),T+=K>>>13,K&=8191;let j=T+A*l+B*c+S*a+I*s+L*(5*y);T=j>>>13,j&=8191,j+=U*(5*p)+C*(5*f)+O*(5*d)+$*(5*h)+_*(5*u),T+=j>>>13,j&=8191;let H=T+A*u+B*l+S*c+I*a+L*s;T=H>>>13,H&=8191,H+=U*(5*y)+C*(5*p)+O*(5*f)+$*(5*d)+_*(5*h),T+=H>>>13,H&=8191;let q=T+A*h+B*u+S*l+I*c+L*a;T=q>>>13,q&=8191,q+=U*s+C*(5*y)+O*(5*p)+$*(5*f)+_*(5*d),T+=q>>>13,q&=8191;let P=T+A*d+B*h+S*u+I*l+L*c;T=P>>>13,P&=8191,P+=U*a+C*s+O*(5*y)+$*(5*p)+_*(5*f),T+=P>>>13,P&=8191;let z=T+A*f+B*d+S*h+I*u+L*l;T=z>>>13,z&=8191,z+=U*c+C*a+O*s+$*(5*y)+_*(5*p),T+=z>>>13,z&=8191;let F=T+A*p+B*f+S*d+I*h+L*u;T=F>>>13,F&=8191,F+=U*l+C*c+O*a+$*s+_*(5*y),T+=F>>>13,F&=8191;let M=T+A*y+B*p+S*f+I*d+L*h;T=M>>>13,M&=8191,M+=U*u+C*l+O*c+$*a+_*s,T+=M>>>13,M&=8191,T=(T<<2)+T|0,T=T+N|0,N=8191&T,T>>>=13,R+=T,i[0]=N,i[1]=R,i[2]=K,i[3]=j,i[4]=H,i[5]=q,i[6]=P,i[7]=z,i[8]=F,i[9]=M}finalize(){const{h:n,pad:e}=this,t=new Uint16Array(10);let r=n[1]>>>13;n[1]&=8191;for(let e=2;e<10;e++)n[e]+=r,r=n[e]>>>13,n[e]&=8191;n[0]+=5*r,r=n[0]>>>13,n[0]&=8191,n[1]+=r,r=n[1]>>>13,n[1]&=8191,n[2]+=r,t[0]=n[0]+5,r=t[0]>>>13,t[0]&=8191;for(let e=1;e<10;e++)t[e]=n[e]+r,r=t[e]>>>13,t[e]&=8191;t[9]-=8192;let i=(1^r)-1;for(let n=0;n<10;n++)t[n]&=i;i=~i;for(let e=0;e<10;e++)n[e]=n[e]&i|t[e];n[0]=65535&(n[0]|n[1]<<13),n[1]=65535&(n[1]>>>3|n[2]<<10),n[2]=65535&(n[2]>>>6|n[3]<<7),n[3]=65535&(n[3]>>>9|n[4]<<4),n[4]=65535&(n[4]>>>12|n[5]<<1|n[6]<<14),n[5]=65535&(n[6]>>>2|n[7]<<11),n[6]=65535&(n[7]>>>5|n[8]<<8),n[7]=65535&(n[8]>>>8|n[9]<<5);let o=n[0]+e[0];n[0]=65535&o;for(let t=1;t<8;t++)o=(n[t]+e[t]|0)+(o>>>16)|0,n[t]=65535&o}update(n){kt.exists(this);const{buffer:e,blockLen:t}=this,r=(n=mt(n)).length;for(let i=0;i<r;){const o=Math.min(t-this.pos,r-i);if(o!==t)e.set(n.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===t&&(this.process(e,0,!1),this.pos=0);else for(;t<=r-i;i+=t)this.process(n,i)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(n){kt.exists(this),kt.output(n,this),this.finished=!0;const{buffer:e,h:t}=this;let{pos:r}=this;if(r){for(e[r++]=1;r<16;r++)e[r]=0;this.process(e,0,!0)}this.finalize();let i=0;for(let e=0;e<8;e++)n[i++]=t[e]>>>0,n[i++]=t[e]>>>8;return n}digest(){const{buffer:n,outputLen:e}=this;this.digestInto(n);const t=n.slice(0,e);return this.destroy(),t}}!function(n){const e=(e,t)=>n(t).update(mt(e)).digest(),t=n(new Uint8Array(32));e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=e=>n(e)}((n=>new Bt(n)));const St=bt("expand 16-byte k"),It=bt("expand 32-byte k"),Lt=wt(St),Ut=wt(It),Ct=n=>!(n.byteOffset%4),Ot=(n,e)=>n<<e|n>>>32-e;const $t=(n=>{const{core:e,rounds:t,counterRight:r,counterLen:i,allow128bitKeys:o,extendNonceFn:s,blockLen:a}=function(n,e){if(void 0!==e&&("object"!=typeof e||(t=e,"[object Object]"!==Object.prototype.toString.call(t)||t.constructor!==Object)))throw new Error("options must be object or undefined");var t;return Object.assign(n,e)}({rounds:20,counterRight:!1,counterLen:8,allow128bitKeys:!0,blockLen:64},n);kt.number(i),kt.number(t),kt.number(a),kt.bool(r),kt.bool(o);const c=a/4;if(a%4!=0)throw new Error("Salsa/ChaCha: blockLen must be aligned to 4 bytes");return(n,l,u,h,d=0)=>{if(kt.bytes(n),kt.bytes(l),kt.bytes(u),h||(h=new Uint8Array(u.length)),kt.bytes(h),kt.number(d),d<0||d>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");if(h.length<u.length)throw new Error(`Salsa/ChaCha: output (${h.length}) is shorter than data (${u.length})`);const f=[];let p,y;if(32===n.length)p=n,y=Ut;else{if(16!==n.length||!o)throw new Error(`Salsa/ChaCha: invalid 32-byte key, got length=${n.length}`);p=new Uint8Array(32),p.set(n),p.set(n,16),y=Lt,f.push(p)}if(s){if(l.length<=16)throw new Error("Salsa/ChaCha: extended nonce must be bigger than 16 bytes");p=s(y,p,l.subarray(0,16),new Uint8Array(32)),f.push(p),l=l.subarray(16)}const g=16-i;if(l.length!==g)throw new Error(`Salsa/ChaCha: nonce must be ${g} or 16 bytes`);if(12!==g){const n=new Uint8Array(12);n.set(l,r?0:12-l.length),f.push(l=n)}const w=new Uint8Array(a),b=wt(w),m=wt(p),v=wt(l),E=Ct(u)&&wt(u),x=Ct(h)&&wt(h);f.push(b);const k=u.length;for(let n=0,r=d;n<k;r++){if(e(y,m,v,b,r,t),r>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");const i=Math.min(a,k-n);if(i===a&&x&&E){const e=n/4;if(n%4!=0)throw new Error("Salsa/ChaCha: invalid block position");for(let n=0;n<c;n++)x[e+n]=E[e+n]^b[n];n+=a}else{for(let e=0;e<i;e++)h[n+e]=u[n+e]^w[e];n+=i}}for(let n=0;n<f.length;n++)f[n].fill(0);return h}})({core:function(n,e,t,r,i,o=20){let s=n[0],a=n[1],c=n[2],l=n[3],u=e[0],h=e[1],d=e[2],f=e[3],p=e[4],y=e[5],g=e[6],w=e[7],b=i,m=t[0],v=t[1],E=t[2],x=s,k=a,A=c,B=l,S=u,I=h,L=d,U=f,C=p,O=y,$=g,_=w,T=b,N=m,R=v,K=E;for(let n=0;n<o;n+=2)x=x+S|0,T=Ot(T^x,16),C=C+T|0,S=Ot(S^C,12),x=x+S|0,T=Ot(T^x,8),C=C+T|0,S=Ot(S^C,7),k=k+I|0,N=Ot(N^k,16),O=O+N|0,I=Ot(I^O,12),k=k+I|0,N=Ot(N^k,8),O=O+N|0,I=Ot(I^O,7),A=A+L|0,R=Ot(R^A,16),$=$+R|0,L=Ot(L^$,12),A=A+L|0,R=Ot(R^A,8),$=$+R|0,L=Ot(L^$,7),B=B+U|0,K=Ot(K^B,16),_=_+K|0,U=Ot(U^_,12),B=B+U|0,K=Ot(K^B,8),_=_+K|0,U=Ot(U^_,7),x=x+I|0,K=Ot(K^x,16),$=$+K|0,I=Ot(I^$,12),x=x+I|0,K=Ot(K^x,8),$=$+K|0,I=Ot(I^$,7),k=k+L|0,T=Ot(T^k,16),_=_+T|0,L=Ot(L^_,12),k=k+L|0,T=Ot(T^k,8),_=_+T|0,L=Ot(L^_,7),A=A+U|0,N=Ot(N^A,16),C=C+N|0,U=Ot(U^C,12),A=A+U|0,N=Ot(N^A,8),C=C+N|0,U=Ot(U^C,7),B=B+S|0,R=Ot(R^B,16),O=O+R|0,S=Ot(S^O,12),B=B+S|0,R=Ot(R^B,8),O=O+R|0,S=Ot(S^O,7);let j=0;r[j++]=s+x|0,r[j++]=a+k|0,r[j++]=c+A|0,r[j++]=l+B|0,r[j++]=u+S|0,r[j++]=h+I|0,r[j++]=d+L|0,r[j++]=f+U|0,r[j++]=p+C|0,r[j++]=y+O|0,r[j++]=g+$|0,r[j++]=w+_|0,r[j++]=b+T|0,r[j++]=m+N|0,r[j++]=v+R|0,r[j++]=E+K|0},counterRight:!1,counterLen:4,allow128bitKeys:!1}),_t=new Uint8Array([0]),Tt=new Uint8Array;var Nt=Object.defineProperty,Rt=(n,e)=>{for(var t in e)Nt(n,t,{get:e[t],enumerable:!0})};function Kt(){return h(zn.utils.randomPrivateKey())}function jt(n){return h(zn.getPublicKey(n))}var Ht={};Rt(Ht,{MessageNode:()=>Dt,MessageQueue:()=>Vt,insertEventIntoAscendingList:()=>Mt,insertEventIntoDescendingList:()=>Ft,normalizeURL:()=>zt,utf8Decoder:()=>qt,utf8Encoder:()=>Pt});var qt=new TextDecoder("utf-8"),Pt=new TextEncoder;function zt(n){let e=new URL(n);return e.pathname=e.pathname.replace(/\/+/g,"/"),e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1)),("80"===e.port&&"ws:"===e.protocol||"443"===e.port&&"wss:"===e.protocol)&&(e.port=""),e.searchParams.sort(),e.hash="",e.toString()}function Ft(n,e){let t,r=0,i=n.length-1,o=r;if(i<0)o=0;else if(e.created_at<n[i].created_at)o=i+1;else if(e.created_at>=n[r].created_at)o=r;else for(;;){if(i<=r+1){o=i;break}if(t=Math.floor(r+(i-r)/2),n[t].created_at>e.created_at)r=t;else{if(!(n[t].created_at<e.created_at)){o=t;break}i=t}}return n[o]?.id!==e.id?[...n.slice(0,o),e,...n.slice(o)]:n}function Mt(n,e){let t,r=0,i=n.length-1,o=r;if(i<0)o=0;else if(e.created_at>n[i].created_at)o=i+1;else if(e.created_at<=n[r].created_at)o=r;else for(;;){if(i<=r+1){o=i;break}if(t=Math.floor(r+(i-r)/2),n[t].created_at<e.created_at)r=t;else{if(!(n[t].created_at>e.created_at)){o=t;break}i=t}}return n[o]?.id!==e.id?[...n.slice(0,o),e,...n.slice(o)]:n}var Dt=class{_value;_next;get value(){return this._value}set value(n){this._value=n}get next(){return this._next}set next(n){this._next=n}constructor(n){this._value=n,this._next=null}},Vt=class{_first;_last;get first(){return this._first}set first(n){this._first=n}get last(){return this._last}set last(n){this._last=n}_size;get size(){return this._size}set size(n){this._size=n}constructor(){this._first=null,this._last=null,this._size=0}enqueue(n){const e=new Dt(n);return 0!==this._size&&this._last?(this._last.next=e,this._last=e):(this._first=e,this._last=e),this._size++,!0}dequeue(){if(0===this._size||!this._first)return null;let n=this._first;return this._first=n.next,n.next=null,this._size--,n.value}},Zt=Symbol("verified"),Gt=(n=>(n[n.Metadata=0]="Metadata",n[n.Text=1]="Text",n[n.RecommendRelay=2]="RecommendRelay",n[n.Contacts=3]="Contacts",n[n.EncryptedDirectMessage=4]="EncryptedDirectMessage",n[n.EventDeletion=5]="EventDeletion",n[n.Repost=6]="Repost",n[n.Reaction=7]="Reaction",n[n.BadgeAward=8]="BadgeAward",n[n.ChannelCreation=40]="ChannelCreation",n[n.ChannelMetadata=41]="ChannelMetadata",n[n.ChannelMessage=42]="ChannelMessage",n[n.ChannelHideMessage=43]="ChannelHideMessage",n[n.ChannelMuteUser=44]="ChannelMuteUser",n[n.Blank=255]="Blank",n[n.Report=1984]="Report",n[n.ZapRequest=9734]="ZapRequest",n[n.Zap=9735]="Zap",n[n.RelayList=10002]="RelayList",n[n.ClientAuth=22242]="ClientAuth",n[n.NwcRequest=23194]="NwcRequest",n[n.HttpAuth=27235]="HttpAuth",n[n.ProfileBadge=30008]="ProfileBadge",n[n.BadgeDefinition=30009]="BadgeDefinition",n[n.Article=30023]="Article",n[n.FileMetadata=1063]="FileMetadata",n))(Gt||{});function Wt(n=255){return{kind:n,content:"",tags:[],created_at:0}}function Jt(n,e){const t=n;return t.pubkey=jt(e),t.id=Qt(t),t.sig=rr(t,e),t[Zt]=!0,t}function Yt(n){if(!nr(n))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,n.pubkey,n.created_at,n.kind,n.tags,n.content])}function Qt(n){return h(S(Pt.encode(Yt(n))))}var Xt=n=>n instanceof Object;function nr(n){if(!Xt(n))return!1;if("number"!=typeof n.kind)return!1;if("string"!=typeof n.content)return!1;if("number"!=typeof n.created_at)return!1;if("string"!=typeof n.pubkey)return!1;if(!n.pubkey.match(/^[a-f0-9]{64}$/))return!1;if(!Array.isArray(n.tags))return!1;for(let e=0;e<n.tags.length;e++){let t=n.tags[e];if(!Array.isArray(t))return!1;for(let n=0;n<t.length;n++)if("object"==typeof t[n])return!1}return!0}function er(n){if("boolean"==typeof n[Zt])return n[Zt];const e=Qt(n);if(e!==n.id)return n[Zt]=!1;try{return n[Zt]=zn.verify(n.sig,e,n.pubkey)}catch(e){return n[Zt]=!1}}function tr(n,e){return console.warn("nostr-tools: `signEvent` is deprecated and will be removed or changed in the future. Please use `getSignature` instead."),rr(n,e)}function rr(n,e){return h(zn.sign(Qt(n),e))}function ir(n,e){if(n.ids&&-1===n.ids.indexOf(e.id)&&!n.ids.some((n=>e.id.startsWith(n))))return!1;if(n.kinds&&-1===n.kinds.indexOf(e.kind))return!1;if(n.authors&&-1===n.authors.indexOf(e.pubkey)&&!n.authors.some((n=>e.pubkey.startsWith(n))))return!1;for(let t in n)if("#"===t[0]){let r=n[`#${t.slice(1)}`];if(r&&!e.tags.find((([n,e])=>n===t.slice(1)&&-1!==r.indexOf(e))))return!1}return!(n.since&&e.created_at<n.since||n.until&&e.created_at>n.until)}function or(n,e){for(let t=0;t<n.length;t++)if(ir(n[t],e))return!0;return!1}function sr(...n){let e={};for(let t=0;t<n.length;t++){let r=n[t];Object.entries(r).forEach((([n,t])=>{if("kinds"===n||"ids"===n||"authors"===n||"#"===n[0]){e[n]=e[n]||[];for(let r=0;r<t.length;r++){let i=t[r];e[n].includes(i)||e[n].push(i)}}})),r.limit&&(!e.limit||r.limit>e.limit)&&(e.limit=r.limit),r.until&&(!e.until||r.until>e.until)&&(e.until=r.until),r.since&&(!e.since||r.since<e.since)&&(e.since=r.since)}return e}var ar={};function cr(n,e){let t=e.length+3,r=n.indexOf(`"${e}":`)+t,i=n.slice(r).indexOf('"')+r+1;return n.slice(i,i+64)}function lr(n,e){let t=e.length,r=n.indexOf(`"${e}":`)+t+3,i=n.slice(r),o=Math.min(i.indexOf(","),i.indexOf("}"));return parseInt(i.slice(0,o),10)}function ur(n){let e=n.slice(0,22).indexOf('"EVENT"');if(-1===e)return null;let t=n.slice(e+7+1).indexOf('"');if(-1===t)return null;let r=e+7+1+t,i=n.slice(r+1,80).indexOf('"');if(-1===i)return null;let o=r+1+i;return n.slice(r+1,o)}function hr(n,e){return e===cr(n,"id")}function dr(n,e){return e===cr(n,"pubkey")}function fr(n,e){return e===lr(n,"kind")}Rt(ar,{getHex64:()=>cr,getInt:()=>lr,getSubscriptionId:()=>ur,matchEventId:()=>hr,matchEventKind:()=>fr,matchEventPubkey:()=>dr});var pr=()=>({connect:[],disconnect:[],error:[],notice:[],auth:[]});function yr(n,e={}){let{listTimeout:t=3e3,getTimeout:r=3e3,countTimeout:i=3e3}=e;var o,s,a={},c=pr(),l={},u={};function h(){return 1===o?.readyState}async function d(n){let e=JSON.stringify(n);if(h()||(await new Promise((n=>setTimeout(n,1e3))),h()))try{o.send(e)}catch(n){console.log(n)}}const f=(n,{verb:e="REQ",skipVerification:t=!1,alreadyHaveEvent:r=null,id:i=Math.random().toString().slice(2)}={})=>{let o=i;a[o]={id:o,filters:n,skipVerification:t,alreadyHaveEvent:r},d([e,o,...n]);let s={sub:(e,i={})=>f(e||n,{skipVerification:i.skipVerification||t,alreadyHaveEvent:i.alreadyHaveEvent||r,id:o}),unsub:()=>{delete a[o],delete l[o],d(["CLOSE",o])},on:(n,e)=>{l[o]=l[o]||{event:[],count:[],eose:[]},l[o][n].push(e)},off:(n,e)=>{let t=l[o],r=t[n].indexOf(e);r>=0&&t[n].splice(r,1)},get events(){return gr(s)}};return s};function p(n,e){return new Promise(((t,r)=>{if(!n.id)return void r(new Error(`event ${n} has no id`));let i=n.id;d([e,n]),u[i]={resolve:t,reject:r}}))}return{url:n,sub:f,on:(n,e)=>{c[n].push(e),"connect"===n&&1===o?.readyState&&e()},off:(n,e)=>{let t=c[n].indexOf(e);-1!==t&&c[n].splice(t,1)},list:(n,e)=>new Promise((r=>{let i=f(n,e),o=[],s=setTimeout((()=>{i.unsub(),r(o)}),t);i.on("eose",(()=>{i.unsub(),clearTimeout(s),r(o)})),i.on("event",(n=>{o.push(n)}))})),get:(n,e)=>new Promise((t=>{let i=f([n],e),o=setTimeout((()=>{i.unsub(),t(null)}),r);i.on("event",(n=>{i.unsub(),clearTimeout(o),t(n)}))})),count:n=>new Promise((e=>{let t=f(n,{...f,verb:"COUNT"}),r=setTimeout((()=>{t.unsub(),e(null)}),i);t.on("count",(n=>{t.unsub(),clearTimeout(r),e(n)}))})),async publish(n){await p(n,"EVENT")},async auth(n){await p(n,"AUTH")},connect:async function(){h()||await async function(){return s||(s=new Promise(((e,t)=>{try{o=new WebSocket(n)}catch(n){t(n)}o.onopen=()=>{c.connect.forEach((n=>n())),e()},o.onerror=()=>{s=void 0,c.error.forEach((n=>n())),t()},o.onclose=async()=>{s=void 0,c.disconnect.forEach((n=>n()))};let r,i=new Vt;function h(){if(0===i.size)return clearInterval(r),void(r=null);var e=i.dequeue();if(!e)return;let t=ur(e);if(t){let r=a[t];if(r&&r.alreadyHaveEvent&&r.alreadyHaveEvent(cr(e,"id"),n))return}try{let n=JSON.parse(e);switch(n[0]){case"EVENT":{let e=n[1],t=n[2];return void(nr(t)&&a[e]&&(a[e].skipVerification||er(t))&&or(a[e].filters,t)&&(a[e],(l[e]?.event||[]).forEach((n=>n(t)))))}case"COUNT":let e=n[1],t=n[2];return void(a[e]&&(l[e]?.count||[]).forEach((n=>n(t))));case"EOSE":{let e=n[1];return void(e in l&&(l[e].eose.forEach((n=>n())),l[e].eose=[]))}case"OK":{let e=n[1],t=n[2],r=n[3]||"";if(e in u){let{resolve:n,reject:i}=u[e];t?n(null):i(new Error(r))}return}case"NOTICE":let r=n[1];return void c.notice.forEach((n=>n(r)));case"AUTH":{let e=n[1];return void c.auth?.forEach((n=>n(e)))}}}catch(n){return}}o.onmessage=n=>{i.enqueue(n.data),r||(r=setInterval(h,0))}})),s)}()},close(){c=pr(),l={},u={},o?.readyState===WebSocket.OPEN&&o.close()},get status(){return o?.readyState??3}}}async function*gr(n){let e;const t=[],r=n=>{e?(e(n),e=void 0):t.push(n)};n.on("event",r);try{for(;;)if(t.length>0)yield t.shift();else{const n=await new Promise((n=>{e=n}));yield n}}finally{n.off("event",r)}}var wr=class{_conn;_seenOn={};batchedByKey={};eoseSubTimeout;getTimeout;seenOnEnabled=!0;batchInterval=100;constructor(n={}){this._conn={},this.eoseSubTimeout=n.eoseSubTimeout||3400,this.getTimeout=n.getTimeout||3400,this.seenOnEnabled=!1!==n.seenOnEnabled,this.batchInterval=n.batchInterval||100}close(n){n.forEach((n=>{let e=this._conn[zt(n)];e&&e.close()}))}async ensureRelay(n){const e=zt(n);this._conn[e]||(this._conn[e]=yr(e,{getTimeout:.9*this.getTimeout,listTimeout:.9*this.getTimeout}));const t=this._conn[e];return await t.connect(),t}sub(n,e,t){let r=new Set,i={...t||{}};i.alreadyHaveEvent=(n,e)=>{if(t?.alreadyHaveEvent?.(n,e))return!0;if(this.seenOnEnabled){let t=this._seenOn[n]||new Set;t.add(e),this._seenOn[n]=t}return r.has(n)};let o=[],s=new Set,a=new Set,c=n.length,l=!1,u=setTimeout((()=>{l=!0;for(let n of a.values())n()}),t?.eoseSubTimeout||this.eoseSubTimeout);n.filter(((n,e,t)=>t.indexOf(n)===e)).forEach((async n=>{let t;try{t=await this.ensureRelay(n)}catch(n){return void d()}if(!t)return;let h=t.sub(e,i);function d(){if(c--,0===c){clearTimeout(u);for(let n of a.values())n()}}h.on("event",(n=>{r.add(n.id);for(let e of s.values())e(n)})),h.on("eose",(()=>{l||d()})),o.push(h)}));let h={sub:(n,e)=>(o.forEach((t=>t.sub(n,e))),h),unsub(){o.forEach((n=>n.unsub()))},on(n,e){"event"===n?s.add(e):"eose"===n&&a.add(e)},off(n,e){"event"===n?s.delete(e):"eose"===n&&a.delete(e)},get events(){return gr(h)}};return h}get(n,e,t){return new Promise((r=>{let i=this.sub(n,[e],t),o=setTimeout((()=>{i.unsub(),r(null)}),this.getTimeout);i.on("event",(n=>{r(n),clearTimeout(o),i.unsub()}))}))}list(n,e,t){return new Promise((r=>{let i=[],o=this.sub(n,e,t);o.on("event",(n=>{i.push(n)})),o.on("eose",(()=>{o.unsub(),r(i)}))}))}batchedList(n,e,t){return new Promise((r=>{this.batchedByKey[n]?this.batchedByKey[n].push({filters:t,relays:e,resolve:r,events:[]}):(this.batchedByKey[n]=[{filters:t,relays:e,resolve:r,events:[]}],setTimeout((()=>{Object.keys(this.batchedByKey).forEach((async n=>{const e=this.batchedByKey[n],t=[],r=[];e.forEach((n=>{t.push(...n.filters),r.push(...n.relays)}));const i=this.sub(r,[sr(...t)]);i.on("event",(n=>{e.forEach((e=>or(e.filters,n)&&e.events.push(n)))})),i.on("eose",(()=>{i.unsub(),e.forEach((n=>n.resolve(n.events)))})),delete this.batchedByKey[n]}))}),this.batchInterval))}))}publish(n,e){return n.map((async n=>(await this.ensureRelay(n)).publish(e)))}seenOn(n){return Array.from(this._seenOn[n]?.values?.()||[])}},br={};Rt(br,{BECH32_REGEX:()=>vr,decode:()=>Er,naddrEncode:()=>Cr,neventEncode:()=>Ur,noteEncode:()=>Br,nprofileEncode:()=>Lr,npubEncode:()=>Ar,nrelayEncode:()=>Or,nsecEncode:()=>kr});var mr=5e3,vr=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function Er(n){let{prefix:e,words:t}=de.decode(n,mr),r=new Uint8Array(de.fromWords(t));switch(e){case"nprofile":{let n=xr(r);if(!n[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(32!==n[0][0].length)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:h(n[0][0]),relays:n[1]?n[1].map((n=>qt.decode(n))):[]}}}case"nevent":{let n=xr(r);if(!n[0]?.[0])throw new Error("missing TLV 0 for nevent");if(32!==n[0][0].length)throw new Error("TLV 0 should be 32 bytes");if(n[2]&&32!==n[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(n[3]&&4!==n[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:h(n[0][0]),relays:n[1]?n[1].map((n=>qt.decode(n))):[],author:n[2]?.[0]?h(n[2][0]):void 0,kind:n[3]?.[0]?parseInt(h(n[3][0]),16):void 0}}}case"naddr":{let n=xr(r);if(!n[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!n[2]?.[0])throw new Error("missing TLV 2 for naddr");if(32!==n[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(!n[3]?.[0])throw new Error("missing TLV 3 for naddr");if(4!==n[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:qt.decode(n[0][0]),pubkey:h(n[2][0]),kind:parseInt(h(n[3][0]),16),relays:n[1]?n[1].map((n=>qt.decode(n))):[]}}}case"nrelay":{let n=xr(r);if(!n[0]?.[0])throw new Error("missing TLV 0 for nrelay");return{type:"nrelay",data:qt.decode(n[0][0])}}case"nsec":case"npub":case"note":return{type:e,data:h(r)};default:throw new Error(`unknown prefix ${e}`)}}function xr(n){let e={},t=n;for(;t.length>0;){let n=t[0],r=t[1];if(!r)throw new Error(`malformed TLV ${n}`);let i=t.slice(2,2+r);if(t=t.slice(2+r),i.length<r)throw new Error(`not enough data to read on TLV ${n}`);e[n]=e[n]||[],e[n].push(i)}return e}function kr(n){return Ir("nsec",n)}function Ar(n){return Ir("npub",n)}function Br(n){return Ir("note",n)}function Sr(n,e){let t=de.toWords(e);return de.encode(n,t,mr)}function Ir(n,e){return Sr(n,d(e))}function Lr(n){return Sr("nprofile",$r({0:[d(n.pubkey)],1:(n.relays||[]).map((n=>Pt.encode(n)))}))}function Ur(n){let e;return null!=n.kind&&(e=function(n){const e=new Uint8Array(4);return e[0]=n>>24&255,e[1]=n>>16&255,e[2]=n>>8&255,e[3]=255&n,e}(n.kind)),Sr("nevent",$r({0:[d(n.id)],1:(n.relays||[]).map((n=>Pt.encode(n))),2:n.author?[d(n.author)]:[],3:e?[new Uint8Array(e)]:[]}))}function Cr(n){let e=new ArrayBuffer(4);return new DataView(e).setUint32(0,n.kind,!1),Sr("naddr",$r({0:[Pt.encode(n.identifier)],1:(n.relays||[]).map((n=>Pt.encode(n))),2:[d(n.pubkey)],3:[new Uint8Array(e)]}))}function Or(n){return Sr("nrelay",$r({0:[Pt.encode(n)]}))}function $r(n){let e=[];return Object.entries(n).forEach((([n,t])=>{t.forEach((t=>{let r=new Uint8Array(t.length+2);r.set([parseInt(n)],0),r.set([t.length],1),r.set(t,2),e.push(r)}))})),y(...e)}var _r=/\bnostr:((note|npub|naddr|nevent|nprofile)1\w+)\b|#\[(\d+)\]/g;function Tr(n){let e=[];for(let t of n.content.matchAll(_r))if(t[2])try{let{type:n,data:r}=Er(t[1]);switch(n){case"npub":e.push({text:t[0],profile:{pubkey:r,relays:[]}});break;case"nprofile":e.push({text:t[0],profile:r});break;case"note":e.push({text:t[0],event:{id:r,relays:[]}});break;case"nevent":e.push({text:t[0],event:r});break;case"naddr":e.push({text:t[0],address:r})}}catch(n){}else if(t[3]){let r=parseInt(t[3],10),i=n.tags[r];if(!i)continue;switch(i[0]){case"p":e.push({text:t[0],profile:{pubkey:i[1],relays:i[2]?[i[2]]:[]}});break;case"e":e.push({text:t[0],event:{id:i[1],relays:i[2]?[i[2]]:[]}});break;case"a":try{let[n,r,o]=i[1].split(":");e.push({text:t[0],address:{identifier:o,pubkey:r,kind:parseInt(n,10),relays:i[2]?[i[2]]:[]}})}catch(n){}}}return e}var Nr={};async function Rr(n,e,t){const r=jr(Sn.getSharedSecret(n,"02"+e));let i=Uint8Array.from(b(16)),o=Pt.encode(t),s=await crypto.subtle.importKey("raw",r,{name:"AES-CBC"},!1,["encrypt"]),a=await crypto.subtle.encrypt({name:"AES-CBC",iv:i},s,o);return`${ie.encode(new Uint8Array(a))}?iv=${ie.encode(new Uint8Array(i.buffer))}`}async function Kr(n,e,t){let[r,i]=t.split("?iv="),o=jr(Sn.getSharedSecret(n,"02"+e)),s=await crypto.subtle.importKey("raw",o,{name:"AES-CBC"},!1,["decrypt"]),a=ie.decode(r),c=ie.decode(i),l=await crypto.subtle.decrypt({name:"AES-CBC",iv:c},s,a);return qt.decode(l)}function jr(n){return n.slice(1,33)}Rt(Nr,{decrypt:()=>Kr,encrypt:()=>Rr}),"undefined"!=typeof crypto&&!crypto.subtle&&crypto.webcrypto&&(crypto.subtle=crypto.webcrypto.subtle);var Hr={};Rt(Hr,{NIP05_REGEX:()=>Pr,queryProfile:()=>Mr,searchDomain:()=>Fr,useFetchImplementation:()=>zr});var qr,Pr=/^(?:([\w.+-]+)@)?([\w.-]+)$/;try{qr=fetch}catch{}function zr(n){qr=n}async function Fr(n,e=""){try{return(await(await qr(`https://${n}/.well-known/nostr.json?name=${e}`)).json()).names}catch(n){return{}}}async function Mr(n){const e=n.match(Pr);if(!e)return null;const[t,r="_",i]=e;try{const n=await qr(`https://${i}/.well-known/nostr.json?name=${r}`),{names:e,relays:t}=function(n){const e={names:{}};for(const[t,r]of Object.entries(n.names))"string"==typeof t&&"string"==typeof r&&(e.names[t]=r);if(n.relays){e.relays={};for(const[t,r]of Object.entries(n.relays))"string"==typeof t&&Array.isArray(r)&&(e.relays[t]=r.filter((n=>"string"==typeof n)))}return e}(await n.json()),o=e[r];return o?{pubkey:o,relays:t?.[o]}:null}catch(n){return null}}var Dr={};function Vr(n,e){let t=gt.fromMasterSeed(Ve(n,e)).derive("m/44'/1237'/0'/0/0").privateKey;if(!t)throw new Error("could not derive private key");return h(t)}function Zr(){return function(n,e=128){if(o.number(e),e%32!=0||e>256)throw new TypeError("Invalid entropy");return function(n,e){return Fe(n),De(e).encode(n).join((n=>""===n[0])(e)?"":" ")}(b(e/8),n)}(fe)}function Gr(n){return function(n,e){try{!function(n,e){const{words:t}=ze(n);Fe(De(e).decode(t))}(n,e)}catch(n){return!1}return!0}(n,fe)}Rt(Dr,{generateSeedWords:()=>Zr,privateKeyFromSeedWords:()=>Vr,validateWords:()=>Gr});var Wr={};function Jr(n){const e={reply:void 0,root:void 0,mentions:[],profiles:[]},t=[];for(const r of n.tags)"e"===r[0]&&r[1]&&t.push(r),"p"===r[0]&&r[1]&&e.profiles.push({pubkey:r[1],relays:r[2]?[r[2]]:[]});for(let n=0;n<t.length;n++){const r=t[n],[i,o,s,a]=r,c={id:o,relays:s?[s]:[]},l=0===n,u=n===t.length-1;"root"!==a?"reply"!==a?"mention"!==a?l?e.root=c:u?e.reply=c:e.mentions.push(c):e.mentions.push(c):e.reply=c:e.root=c}return e}Rt(Wr,{parse:()=>Jr});var Yr={};function Qr(n){let e=0;for(let t=0;t<n.length;t++){const r=parseInt(n[t],16);if(0!==r){e+=Math.clz32(r)-28;break}e+=4}return e}function Xr(n,e){let t=0;const r=n,i=["nonce",t.toString(),e.toString()];for(r.tags.push(i);;){const n=Math.floor((new Date).getTime()/1e3);if(n!==r.created_at&&(t=0,r.created_at=n),i[1]=(++t).toString(),r.id=Qt(r),Qr(r.id)>=e)break}return r}Rt(Yr,{getPow:()=>Qr,minePow:()=>Xr});var ni={};function ei(n,e,t,r){return Jt({kind:6,tags:[...n.tags??[],["e",e.id,t],["p",e.pubkey]],content:""===n.content?"":JSON.stringify(e),created_at:n.created_at},r)}function ti(n){if(6!==n.kind)return;let e,t;for(let r=n.tags.length-1;r>=0&&(void 0===e||void 0===t);r--){const i=n.tags[r];i.length>=2&&("e"===i[0]&&void 0===e?e=i:"p"===i[0]&&void 0===t&&(t=i))}return void 0!==e?{id:e[1],relays:[e[2],t?.[2]].filter((n=>"string"==typeof n)),author:t?.[1]}:void 0}function ri(n,{skipVerification:e}={}){const t=ti(n);if(void 0===t||""===n.content)return;let r;try{r=JSON.parse(n.content)}catch(n){return}return r.id===t.id&&(e||er(r))?r:void 0}Rt(ni,{finishRepostEvent:()=>ei,getRepostedEvent:()=>ri,getRepostedEventPointer:()=>ti});var ii={};Rt(ii,{NOSTR_URI_REGEX:()=>oi,parse:()=>ai,test:()=>si});var oi=new RegExp(`nostr:(${vr.source})`);function si(n){return"string"==typeof n&&new RegExp(`^${oi.source}$`).test(n)}function ai(n){const e=n.match(new RegExp(`^${oi.source}$`));if(!e)throw new Error(`Invalid Nostr URI: ${n}`);return{uri:e[0],value:e[1],decoded:Er(e[1])}}var ci={};function li(n,e,t){const r=e.tags.filter((n=>n.length>=2&&("e"===n[0]||"p"===n[0])));return Jt({...n,kind:7,tags:[...n.tags??[],...r,["e",e.id],["p",e.pubkey]],content:n.content??"+"},t)}function ui(n){if(7!==n.kind)return;let e,t;for(let r=n.tags.length-1;r>=0&&(void 0===e||void 0===t);r--){const i=n.tags[r];i.length>=2&&("e"===i[0]&&void 0===e?e=i:"p"===i[0]&&void 0===t&&(t=i))}return void 0!==e&&void 0!==t?{id:e[1],relays:[e[2],t[2]].filter((n=>void 0!==n)),author:t[1]}:void 0}Rt(ci,{finishReactionEvent:()=>li,getReactedEventPointer:()=>ui});var hi={};function di(n,e){let t=[];(e.kind||-1)>=0&&t.push(`kind=${e.kind}`),e.until&&t.push(`created_at<${e.until}`),e.since&&t.push(`created_at>${e.since}`);let r=t.join("&");if(""===r)throw new Error("refusing to create a delegation without any conditions");let i=S(Pt.encode(`nostr:delegation:${e.pubkey}:${r}`)),o=h(zn.sign(i,n));return{from:jt(n),to:e.pubkey,cond:r,sig:o}}function fi(n){let e=n.tags.find((n=>"delegation"===n[0]&&n.length>=4));if(!e)return null;let t=e[1],r=e[2],i=e[3],o=r.split("&");for(let e=0;e<o.length;e++){let[t,r,i]=o[e].split(/\b/);if(("kind"!==t||"="!==r||n.kind!==parseInt(i))&&!("created_at"===t&&"<"===r&&n.created_at<parseInt(i)||"created_at"===t&&">"===r&&n.created_at>parseInt(i)))return null}let s=S(Pt.encode(`nostr:delegation:${n.pubkey}:${r}`));return zn.verify(i,s,t)?t:null}Rt(hi,{createDelegation:()=>di,getDelegator:()=>fi});var pi={};Rt(pi,{matchAll:()=>gi,regex:()=>yi,replaceAll:()=>wi});var yi=()=>new RegExp(`\\b${oi.source}\\b`,"g");function*gi(n){const e=n.matchAll(yi());for(const n of e)try{const[e,t]=n;yield{uri:e,value:t,decoded:Er(t),start:n.index,end:n.index+e.length}}catch(n){}}function wi(n,e){return n.replaceAll(yi(),((n,t)=>e({uri:n,value:t,decoded:Er(t)})))}var bi={};Rt(bi,{channelCreateEvent:()=>vi,channelHideMessageEvent:()=>ki,channelMessageEvent:()=>xi,channelMetadataEvent:()=>Ei,channelMuteUserEvent:()=>Ai});var mi,vi=(n,e)=>{let t;if("object"==typeof n.content)t=JSON.stringify(n.content);else{if("string"!=typeof n.content)return;t=n.content}return Jt({kind:40,tags:[...n.tags??[]],content:t,created_at:n.created_at},e)},Ei=(n,e)=>{let t;if("object"==typeof n.content)t=JSON.stringify(n.content);else{if("string"!=typeof n.content)return;t=n.content}return Jt({kind:41,tags:[["e",n.channel_create_event_id],...n.tags??[]],content:t,created_at:n.created_at},e)},xi=(n,e)=>{const t=[["e",n.channel_create_event_id,n.relay_url,"root"]];return n.reply_to_channel_message_event_id&&t.push(["e",n.reply_to_channel_message_event_id,n.relay_url,"reply"]),Jt({kind:42,tags:[...t,...n.tags??[]],content:n.content,created_at:n.created_at},e)},ki=(n,e)=>{let t;if("object"==typeof n.content)t=JSON.stringify(n.content);else{if("string"!=typeof n.content)return;t=n.content}return Jt({kind:43,tags:[["e",n.channel_message_event_id],...n.tags??[]],content:t,created_at:n.created_at},e)},Ai=(n,e)=>{let t;if("object"==typeof n.content)t=JSON.stringify(n.content);else{if("string"!=typeof n.content)return;t=n.content}return Jt({kind:44,tags:[["p",n.pubkey_to_mute],...n.tags??[]],content:t,created_at:n.created_at},e)},Bi={};Rt(Bi,{useFetchImplementation:()=>Si,validateGithub:()=>Ii});try{mi=fetch}catch{}function Si(n){mi=n}async function Ii(n,e,t){try{return await(await mi(`https://gist.github.com/${e}/${t}/raw`)).text()===`Verifying that I control the following Nostr public key: ${n}`}catch(n){return!1}}var Li={};Rt(Li,{authenticate:()=>Ui});var Ui=async({challenge:n,relay:e,sign:t})=>{const r={kind:22242,created_at:Math.floor(Date.now()/1e3),tags:[["relay",e.url],["challenge",n]],content:""};return e.auth(await t(r))},Ci={};Rt(Ci,{decrypt:()=>_i,encrypt:()=>$i,utils:()=>Oi});var Oi={v2:{maxPlaintextSize:65408,minCiphertextSize:100,maxCiphertextSize:102400,getConversationKey:(n,e)=>Sn.getSharedSecret(n,"02"+e).subarray(1,33),getMessageKeys(n,e){const t=((n,e,t,r,i)=>function(n,e,t,r=32){if(o.hash(n),o.number(r),r>255*n.outputLen)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/n.outputLen);void 0===t&&(t=Tt);const s=new Uint8Array(i*n.outputLen),a=wn.create(n,e),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let e=0;e<i;e++)_t[0]=e+1,c.update(0===e?Tt:l).update(t).update(_t).digestInto(l),s.set(l,n.outputLen*e),a._cloneInto(c);return a.destroy(),c.destroy(),l.fill(0),_t.fill(0),s.slice(0,r)}(n,function(n,e,t){return o.hash(n),void 0===t&&(t=new Uint8Array(n.outputLen)),wn(n,p(t),p(e))}(n,e,t),r,i))(S,n,e,"nip44-v2",76);return{encryption:t.subarray(0,32),nonce:t.subarray(32,44),auth:t.subarray(44,76)}},calcPadding(n){if(!Number.isSafeInteger(n)||n<0)throw new Error("expected positive integer");if(n<=32)return 32;const e=1<<Math.floor(Math.log2(n-1))+1,t=e<=256?32:e/8;return t*(Math.floor((n-1)/t)+1)},pad(n){const e=Pt.encode(n),t=e.length;if(t<1||t>=Oi.v2.maxPlaintextSize)throw new Error("invalid plaintext length: must be between 1b and 64KB");const r=Oi.v2.calcPadding(t),i=new Uint8Array(r-t),o=new Uint8Array(2);return new DataView(o.buffer).setUint16(0,t),y(o,e,i)},unpad(n){const e=new DataView(n.buffer).getUint16(0),t=n.subarray(2,2+e);if(0===e||t.length!==e||n.length!==2+Oi.v2.calcPadding(e))throw new Error("invalid padding");return qt.decode(t)}}};function $i(n,e,t={}){const r=t.version??2;if(2!==r)throw new Error("unknown encryption version "+r);const i=t.salt??b(32);vt(i,32);const o=Oi.v2.getMessageKeys(n,i),s=Oi.v2.pad(e),a=$t(o.encryption,o.nonce,s),c=wn(S,o.auth,a);return ie.encode(y(new Uint8Array([r]),i,a,c))}function _i(n,e){const t=Oi.v2;vt(n,32);const r=e.length;if(r<t.minCiphertextSize||r>=t.maxCiphertextSize)throw new Error("invalid ciphertext length: "+r);if("#"===e[0])throw new Error("unknown encryption version");let i;try{i=ie.decode(e)}catch(n){throw new Error("invalid base64: "+n.message)}const o=i.subarray(0,1)[0];if(2!==o)throw new Error("unknown encryption version "+o);const s=i.subarray(1,33),a=i.subarray(33,-32),c=i.subarray(-32),l=t.getMessageKeys(n,s);if(!function(n,e){if(n.length!==e.length)throw new Error("equalBytes: Different size of Uint8Arrays");let t=!0;for(let r=0;r<n.length;r++)t&&(t=n[r]===e[r]);return t}(wn(S,l.auth,a),c))throw new Error("invalid MAC");const u=$t(l.encryption,l.nonce,a);return t.unpad(u)}var Ti={};function Ni(n){const{pathname:e,searchParams:t}=new URL(n),r=e,i=t.get("relay"),o=t.get("secret");if(!r||!i||!o)throw new Error("invalid connection string");return{pubkey:r,relay:i,secret:o}}async function Ri({pubkey:n,secret:e,invoice:t}){const r={method:"pay_invoice",params:{invoice:t}},i=await Rr(e,n,JSON.stringify(r));return Jt({kind:23194,created_at:Math.round(Date.now()/1e3),content:i,tags:[["p",n]]},e)}Rt(Ti,{makeNwcRequestEvent:()=>Ri,parseConnectionString:()=>Ni});var Ki,ji={};Rt(ji,{getZapEndpoint:()=>qi,makeZapReceipt:()=>Fi,makeZapRequest:()=>Pi,useFetchImplementation:()=>Hi,validateZapRequest:()=>zi});try{Ki=fetch}catch{}function Hi(n){Ki=n}async function qi(n){try{let e="",{lud06:t,lud16:r}=JSON.parse(n.content);if(t){let{words:n}=de.decode(t,1e3),r=de.fromWords(n);e=qt.decode(r)}else{if(!r)return null;{let[n,t]=r.split("@");e=`https://${t}/.well-known/lnurlp/${n}`}}let i=await Ki(e),o=await i.json();if(o.allowsNostr&&o.nostrPubkey)return o.callback}catch(n){}return null}function Pi({profile:n,event:e,amount:t,relays:r,comment:i=""}){if(!t)throw new Error("amount not given");if(!n)throw new Error("profile not given");let o={kind:9734,created_at:Math.round(Date.now()/1e3),content:i,tags:[["p",n],["amount",t.toString()],["relays",...r]]};return e&&o.tags.push(["e",e]),o}function zi(n){let e;try{e=JSON.parse(n)}catch(n){return"Invalid zap request JSON."}if(!nr(e))return"Zap request is not a valid Nostr event.";if(!er(e))return"Invalid signature on zap request.";let t=e.tags.find((([n,e])=>"p"===n&&e));if(!t)return"Zap request doesn't have a 'p' tag.";if(!t[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let r=e.tags.find((([n,e])=>"e"===n&&e));return r&&!r[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":e.tags.find((([n,e])=>"relays"===n&&e))?null:"Zap request doesn't have a 'relays' tag."}function Fi({zapRequest:n,preimage:e,bolt11:t,paidAt:r}){let i=JSON.parse(n).tags.filter((([n])=>"e"===n||"p"===n||"a"===n)),o={kind:9735,created_at:Math.round(r.getTime()/1e3),content:"",tags:[...i,["bolt11",t],["description",n]]};return e&&o.tags.push(["preimage",e]),o}var Mi={};Rt(Mi,{getToken:()=>Vi,unpackEventFromToken:()=>Gi,validateEvent:()=>Wi,validateToken:()=>Zi});var Di="Nostr ";async function Vi(n,e,t,r=!1){if(!n||!e)throw new Error("Missing loginUrl or httpMethod");const i=Wt(27235);i.tags=[["u",n],["method",e]],i.created_at=Math.round((new Date).getTime()/1e3);const o=await t(i);return(r?Di:"")+ie.encode(Pt.encode(JSON.stringify(o)))}async function Zi(n,e,t){const r=await Gi(n).catch((n=>{throw n}));return await Wi(r,e,t).catch((n=>{throw n}))}async function Gi(n){if(!n)throw new Error("Missing token");n=n.replace(Di,"");const e=qt.decode(ie.decode(n));if(!e||0===e.length||!e.startsWith("{"))throw new Error("Invalid token");return JSON.parse(e)}async function Wi(n,e,t){if(!n)throw new Error("Invalid nostr event");if(!er(n))throw new Error("Invalid nostr event, signature invalid");if(27235!==n.kind)throw new Error("Invalid nostr event, kind invalid");if(!n.created_at)throw new Error("Invalid nostr event, created_at invalid");if(Math.round((new Date).getTime()/1e3)-n.created_at>60)throw new Error("Invalid nostr event, expired");const r=n.tags.find((n=>"u"===n[0]));if(1!==r?.length&&r?.[1]!==e)throw new Error("Invalid nostr event, url tag invalid");const i=n.tags.find((n=>"method"===n[0]));if(1!==i?.length&&i?.[1].toLowerCase()!==t.toLowerCase())throw new Error("Invalid nostr event, method tag invalid");return!0}class Ji{constructor(){this.relays=["wss://relay.damus.io","wss://relay.nostr.band","wss://nos.lol","wss://relay.nostr.info","wss://nostr.wine","wss://relay.snort.social"],this.relay=null,this.nostrTools=t}async connect(){try{for(const n of this.relays)try{return console.log(`Trying to connect to ${n}...`),this.relay=this.nostrTools.relayInit(n),await this.relay.connect(),console.log(`Connected to ${n}`),!0}catch(e){console.log(`Failed to connect to ${n}:`,e)}return!1}catch(n){return console.error("Failed to connect to any relay:",n),!1}}async searchByName(n){try{const e={kinds:[0],limit:50};let t=[];for(const n of this.relays)try{const r=this.nostrTools.relayInit(n);await r.connect();const i=await r.list([e]);t=[...t,...i]}catch(e){console.log(`Failed to fetch from ${n}:`,e)}const r=t.map((e=>{try{const t=JSON.parse(e.content),r=this.calculateMatchScore(t,n);return{...t,pubkey:e.pubkey,score:r}}catch(n){return null}})).filter((n=>n&&n.score>0)).sort(((n,e)=>e.score-n.score));if(0===r.length)return null;const i=r[0];return{...i,tipOptions:this.extractTipOptions(i)}}catch(n){return console.error("Failed to search by name:",n),null}}async getUserProfile(n){try{let e=n;if(n.startsWith("npub"))e=this.nostrTools.nip19.decode(n).data;else if(!/^[0-9a-f]{64}$/.test(n))return await this.searchByName(n);const t={kinds:[0],authors:[e]},r=await this.relay.list([t]);if(0===r.length)return null;const i=JSON.parse(r[0].content),o=await this.getRecentNotes(e);return{...i,pubkey:r[0].pubkey,tipOptions:this.extractTipOptions(i),recentNotes:o}}catch(n){return console.error("Failed to fetch user profile:",n),null}}extractTipOptions(n){const e={lightning:[],nano:[]};if(n.lud16&&e.lightning.push(n.lud16),n.lud06&&e.lightning.push(n.lud06),n.about){const t=/nano_[13][13456789abcdefghijkmnopqrstuwxyz]{59}/g,r=n.about.match(t)||[];e.nano=r}return console.log("Found tip options:",e),e}async searchProfiles(n){try{if(!n||n.length<2)return[];const e={kinds:[0],limit:20,search:n};let t=[];for(const n of this.relays)try{const r=this.nostrTools.relayInit(n);await r.connect();const i=await r.list([e]);t=[...t,...i]}catch(e){console.log(`Failed to fetch from relay ${n}:`,e)}return t.map((e=>{try{const t=JSON.parse(e.content);return{...t,pubkey:e.pubkey,score:calculateMatchScore(t,n)}}catch(n){return null}})).filter((n=>n&&n.score>0)).sort(((n,e)=>e.score-n.score)).slice(0,5)}catch(n){return console.error("Failed to search profiles:",n),[]}}calculateMatchScore(n,e){const t=e.toLowerCase();let r=0;return n.name?.toLowerCase()===t&&(r+=100),n.display_name?.toLowerCase()===t&&(r+=90),n.nip05?.split("@")[0].toLowerCase()===t&&(r+=80),n.name?.toLowerCase().includes(t)&&(r+=50),n.display_name?.toLowerCase().includes(t)&&(r+=40),n.nip05?.toLowerCase().includes(t)&&(r+=30),n.nip05&&(r+=20),r}async getRecentNotes(n,e=5){try{const t={kinds:[1],authors:[n],limit:e};return(await this.relay.list([t])).map((n=>({content:this.formatNoteContent(n.content),created_at:new Date(1e3*n.created_at).toLocaleString(),id:n.id})))}catch(n){return console.error("Failed to fetch recent notes:",n),[]}}formatNoteContent(n){return(n=(n=(n=n.replace(/https?:\/\/[^\s]+/g,"")).replace(/nostr:[^\s]+/g,"")).trim()).length>280&&(n=n.substring(0,280)+"..."),n}}async function Yi(){return new Promise((n=>{chrome.storage.local.get(["recentSearches","favorites"],(e=>{n({recentSearches:e.recentSearches||[],favorites:e.favorites||[]})}))}))}async function Qi(n,e){return new Promise((t=>{chrome.storage.local.set({[n]:e},t)}))}function Xi(n){document.querySelector(".recent-list").innerHTML=n.map((n=>`\n    <div class="recent-item" data-pubkey="${n.pubkey}">\n      <img src="${n.picture||"../images/default-avatar.jpg"}" \n           onerror="this.src='../images/default-avatar.jpg'" \n           alt="${n.name}">\n      <span>${n.name||"Anonymous"}</span>\n    </div>\n  `)).join("")}function no(n){document.querySelector(".favorites-list").innerHTML=n.map((n=>`\n    <div class="favorite-item" data-pubkey="${n.pubkey}">\n      <img src="${n.picture||"../images/default-avatar.jpg"}" \n           onerror="this.src='../images/default-avatar.jpg'" \n           alt="${n.name}">\n      <span>${n.name||"Anonymous"}</span>\n    </div>\n  `)).join("")}document.addEventListener("DOMContentLoaded",(function(){const n=new Ji,e=document.getElementById("searchInput"),t=document.getElementById("searchButton"),r=document.getElementById("favoriteButton"),i=document.getElementById("results"),o=document.getElementById("searchSuggestions");let s;Yi().then((({recentSearches:n,favorites:e})=>{Xi(n),no(e)})),e.addEventListener("input",(()=>{const t=e.value.trim();s&&clearTimeout(s),t?s=setTimeout((async()=>{try{await n.connect();const e=await n.searchProfiles(t);e.length>0?(o.innerHTML=e.map((n=>`\n            <div class="suggestion-item" data-pubkey="${n.pubkey}">\n              <img src="${n.picture||"../images/default-avatar.jpg"}" \n                   onerror="this.src='../images/default-avatar.jpg'" \n                   alt="${n.name||"Anonymous"}">\n              <div class="suggestion-info">\n                <div class="suggestion-name">${n.name||"Anonymous"}</div>\n                <div class="suggestion-npub">${br.npubEncode(n.pubkey)}</div>\n              </div>\n            </div>\n          `)).join(""),o.classList.add("active")):o.classList.remove("active")}catch(n){console.error("Error fetching suggestions:",n)}}),300):o.classList.remove("active")})),o.addEventListener("click",(n=>{const r=n.target.closest(".suggestion-item");if(r){const n=r.dataset.pubkey;e.value=n,o.classList.remove("active"),t.click()}})),document.addEventListener("click",(n=>{n.target.closest(".search-container")||o.classList.remove("active")})),document.querySelector(".recent-list").addEventListener("click",(async n=>{const r=n.target.closest(".recent-item");if(r){const n=r.dataset.pubkey;e.value=n,t.click()}})),document.querySelector(".favorites-list").addEventListener("click",(async n=>{const r=n.target.closest(".favorite-item");if(r){const n=r.dataset.pubkey;e.value=n,t.click()}})),r.addEventListener("click",(()=>{const n=r.dataset.currentProfile;n&&async function(n){const{favorites:e}=await Yi(),t=e.some((e=>e.pubkey===n.pubkey));let r;r=t?e.filter((e=>e.pubkey!==n.pubkey)):[...e,{pubkey:n.pubkey,name:n.name,picture:n.picture}],await Qi("favorites",r),no(r),document.getElementById("favoriteButton").classList.toggle("active",!t)}(JSON.parse(n))})),t.addEventListener("click",(async()=>{console.log("Search button clicked");const t=e.value.trim();if(t){i.innerHTML="Searching...";try{if(console.log("Attempting to connect to relay..."),!await n.connect())return void(i.innerHTML="Failed to connect to relay");console.log("Connected to relay, fetching profile...");const e=await n.getUserProfile(t);if(!e)return console.log("No profile found"),void(i.innerHTML="User not found");console.log("Found profile:",e),function(n){const e=document.getElementById("results");e.innerHTML="",n?(function(n){const e=document.getElementById("profileBanner");if(n.banner){const t=new Image;t.onload=()=>{e.style.backgroundImage=`url(${n.banner})`},t.onerror=()=>{e.style.backgroundImage="url(../images/default-banner.jpg)"},t.src=n.banner}else e.style.backgroundImage="url(../images/default-banner.jpg)";const t=document.getElementById("profilePicture");t.src=n.picture||"../images/default-avatar.jpg",t.onerror=()=>{t.src="../images/default-avatar.jpg"},document.getElementById("profileName").textContent=n.name||"Anonymous",document.getElementById("profileNpub").textContent=br.npubEncode(n.pubkey),document.getElementById("profileAbout").textContent=n.about||"";const r=document.getElementById("favoriteButton");if(r.innerHTML="Fav",r.dataset.currentProfile=JSON.stringify(n),Yi().then((({favorites:e})=>{r.classList.toggle("active",e.some((e=>e.pubkey===n.pubkey)))})),n.recentNotes&&n.recentNotes.length>0){const e=document.createElement("div");e.className="recent-notes",e.innerHTML=`\n      <h3>Recent Notes</h3>\n      ${n.recentNotes.filter((n=>n.content.trim())).map((n=>`\n          <div class="note-item">\n            <div class="note-content">${n.content}</div>\n            <div class="note-date">${n.created_at}</div>\n          </div>\n        `)).join("")}\n    `;const t=document.getElementById("results");t.insertBefore(e,t.firstChild)}}(n),n.tipOptions&&Object.entries(n.tipOptions).forEach((([n,t])=>{if(t&&t.length>0){console.log(`Found ${n} addresses:`,t);const r=document.createElement("div");r.className="tip-option",r.innerHTML=`<h3>${n.charAt(0).toUpperCase()+n.slice(1)}</h3>`,t.forEach((n=>{const e=document.createElement("div");e.className="address-container",e.innerHTML=`\n              <span class="address" title="${n}">${n}</span>\n              <button class="copy-button" data-address="${n}">Copy</button>\n            `,r.appendChild(e)})),e.appendChild(r)}})),document.querySelectorAll(".copy-button").forEach((n=>{n.addEventListener("click",(async n=>{const e=n.target,t=e.dataset.address;try{await navigator.clipboard.writeText(t);const n=e.textContent;e.textContent="Copied!",e.classList.add("copied"),setTimeout((()=>{e.textContent=n,e.classList.remove("copied")}),2e3)}catch(n){console.error("Failed to copy:",n)}}))})),function(n){Yi().then((({recentSearches:e})=>{const t=[{pubkey:n.pubkey,name:n.name,picture:n.picture},...e.filter((e=>e.pubkey!==n.pubkey))].slice(0,5);Qi("recentSearches",t),Xi(t)}))}(n)):e.innerHTML="No profile found"}(e)}catch(n){console.error("Error in search:",n),i.innerHTML="Error fetching user data."}}else console.log("No identifier provided")}))}))})();